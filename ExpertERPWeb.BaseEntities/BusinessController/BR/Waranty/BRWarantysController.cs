using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region BRWarantys
	//-----------------------------------------------------------
	//Generated By: Expert Studio
	//Class:BRWarantysController
	//Created Date:Thursday, October 21, 2010
	//-----------------------------------------------------------
	
	public class BRWarantysController:BaseBusinessController
	{
		public BRWarantysController()
		{
			dal= new DALBaseProvider("BRWarantys",typeof(BRWarantysInfo));
		}

        public DataSet GetWarantysByBranchAndRangeCompleteDate(int iBRBranchID,DateTime dtFromDate, DateTime dtToDate)
        {
            string strDateFormat = "yyyy/MM/dd";

            String strQuery= String.Format("Select * From [BRWarantys] WHERE ([FK_BRBranchID]={0})AND(convert(varchar(10),[BRWarantyCompleteDate],111)>='{1}')AND (convert(varchar(10),[BRWarantyCompleteDate],111)<='{2}')",iBRBranchID,dtFromDate.ToString(strDateFormat),dtToDate.ToString(strDateFormat));
            return dal.GetDataSet(strQuery);
        }

        public DataSet GetExpireWarantysByBranchAndRangeCompleteDate(int iBRBranchID, DateTime dtFromDate, DateTime dtToDate)
        {
            string strDateFormat = "yyyy/MM/dd";
            String strQuery = String.Format("Select * From [BRWarantys] WHERE ([FK_BRBranchID]={0})AND(convert(varchar(10), [BRWarantyExpireDate],111)>='{1}')AND (convert(varchar(10),[BRWarantyExpireDate],111)<='{2}') AND ([BRWarantyStatus]<>'Complete'  ) and AAStatus='Alive' ", iBRBranchID, dtFromDate.ToString(strDateFormat), dtToDate.ToString(strDateFormat));
            return dal.GetDataSet(strQuery);
        }

        public DataSet GetWarantysByBranchAndRangeCompleteDateAndWarantyStateComplete(int iBRBranchID, DateTime dtFromDate, DateTime dtToDate)
        {

            string strDateFormat = "yyyy/MM/dd";

            String strQuery = String.Format("Select * From [BRWarantys] WHERE ([FK_BRBranchID]={0})AND(convert(varchar(10),[BRWarantyCompleteDate],111)>='{1}')AND (convert(varchar(10),[BRWarantyCompleteDate],111)<='{2}'  and BRWarantyStatus='Complete' and AAStatus='Alive'  )", iBRBranchID, dtFromDate.ToString(strDateFormat), dtToDate.ToString(strDateFormat));
            return dal.GetDataSet(strQuery);
        }

        public DataSet GetWarantysByWarantyProductSerialNo(String strSerialNo)
        {
            string strQuery = String.Format("Select * From [BRWarantys] WHERE AAStatus='Alive' and BRWarantyProductSerialNo='{0}'", strSerialNo);
            return dal.GetDataSet(strQuery);
        }
	}
	#endregion
}