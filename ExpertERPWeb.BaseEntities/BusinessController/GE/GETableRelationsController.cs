using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
using System.Windows.Forms;
namespace ExpertERP.BusinessEntities
{
	#region GETableRelations
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:GETableRelationsController
	//Created Date:Monday, January 09, 2012
	//-----------------------------------------------------------
	
	public class GETableRelationsController:BaseBusinessController
	{
		public GETableRelationsController()
		{
			dal= new DALBaseProvider("GETableRelations",typeof(GETableRelationsInfo));
		}
        public DataSet GetAllDataByParentTableName(string strParentTableName, bool bActionEdit = false)
        {
            string strQuery = string.Format("Select * from GETableRelations where AAStatus='Alive' and GETableRelationParent ='{0}'", strParentTableName);
            if (bActionEdit)
                strQuery += " AND GETableRelationEditCheck = 1";
            DataSet ds = dal.GetDataSet(strQuery);
            return ds;
        }
        public bool CheckExistByParentChildTableNameAndParentTableID(string strParentTableName, string strChildTableName, int iParentTableID)
        {
            string strFK = "FK_"+strParentTableName.Substring(0, strParentTableName.Length - 1) + "ID";
            string strQuery = string.Format("Select * from {0} where AAStatus='Alive' and {1} = {2}", strChildTableName, strFK, iParentTableID);
            DataSet ds = new DataSet();
            try
            {
               if(GMCDbUtil.ColumnIsExist(strChildTableName, strFK))
                    ds = dal.GetDataSet(strQuery);
            }
            catch (System.Exception ex)
            {
                ds = null;
                MessageBox.Show(ex.Message);
            }
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
                return true;
            return false;
        }
	}
	#endregion
}