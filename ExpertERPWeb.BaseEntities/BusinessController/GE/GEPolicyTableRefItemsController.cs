using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region GEPolicyTableRefItems
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:GEPolicyTableRefItemsController
	//Created Date:Tuesday, April 25, 2017
	//-----------------------------------------------------------
	
	public class GEPolicyTableRefItemsController:BaseBusinessController
	{
		public GEPolicyTableRefItemsController()
		{
			dal= new DALBaseProvider("GEPolicyTableRefItems",typeof(GEPolicyTableRefItemsInfo));
		}

        public DataSet GetTableRefItemByPolicyDefineMthID(DateTime dteFromDte, DateTime dteToDte,int iPolicyDefineMthID)
        {
            string strQuery= string.Format(@"SELECT GEPolicyTableRefItems.*
                                FROM GEPolicyTableRefItems 
                                JOIN  GEPolicyTableRefs ON (GEPolicyTableRefs.AAStatus = GEPolicyTableRefItems.AAStatus
                                 AND GEPolicyTableRefs.GEPolicyTableRefID = GEPolicyTableRefItems.FK_GEPolicyTableRefID)
                                WHERE GEPolicyTableRefs.AAStatus='Alive'
                                AND('{0}' BETWEEN CONVERT(VARCHAR(10),GEPolicyTableRefs.GEPolicyTableRefFromDate,112)  AND CONVERT(VARCHAR(10),GEPolicyTableRefs.GEPolicyTableRefToDate,112))
                               AND('{1}' BETWEEN CONVERT(VARCHAR(10),GEPolicyTableRefs.GEPolicyTableRefFromDate,112)  AND CONVERT(VARCHAR(10),GEPolicyTableRefs.GEPolicyTableRefToDate,112))
                                 AND  FK_GEPolicyMthCfgID={2}", dteFromDte.ToString("yyyyMMdd"), dteToDte.ToString("yyyyMMdd"), iPolicyDefineMthID);
            return dal.GetDataSet(strQuery);
        }
	}
	#endregion
}