using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ACCostSimulationRMPriceListItems
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ACCostSimulationRMPriceListItemsController
	//Created Date:21 Tháng Bảy 2014
	//-----------------------------------------------------------
	
	public class ACCostSimulationRMPriceListItemsController:BaseBusinessController
	{
		public ACCostSimulationRMPriceListItemsController()
		{
			dal= new DALBaseProvider("ACCostSimulationRMPriceListItems",typeof(ACCostSimulationRMPriceListItemsInfo));
		}
        
        public double GetUnitPriceByProduct(int iICProductID, DateTime dt)
        {
            String str = String.Format(@"   SELECT ACCostSimulationRMPriceListItemUnitPrice FROM dbo.ACCostSimulationRMPriceListItems
                                            WHERE AAStatus = 'Alive'
                                            AND FK_ACCostSimulationRMPriceListID IN (
										                                            SELECT ACCostSimulationRMPriceListID FROM dbo.ACCostSimulationRMPriceLists
										                                            WHERE AAStatus = 'Alive'
										                                            )
										    AND CONVERT(VARCHAR, ACCostSimulationRMPriceListItemFromDate, 112) <= '{1}'
										    AND CONVERT(VARCHAR, ACCostSimulationRMPriceListItemToDate, 112) >= '{1}'
                                            AND FK_ICProductID = {0}
                                            ", iICProductID, dt.ToString("yyyyMMdd"));
            DataSet ds = dal.GetDataSet(str);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0 && ds.Tables[0].Rows[0][0] != DBNull.Value)
            {
                return Convert.ToDouble(ds.Tables[0].Rows[0][0]);
            }

            return 0;
        }
	}
	#endregion
}