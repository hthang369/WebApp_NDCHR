using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ViewReceiptStatistics
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ViewReceiptStatisticsController
	//Created Date:26 Tháng Ba 2013
	//-----------------------------------------------------------
	
	public class ViewReceiptStatisticsController:BaseBusinessController
	{
		public ViewReceiptStatisticsController()
		{
			dal= new DALBaseProvider("ViewReceiptStatistics",typeof(ViewReceiptStatisticsInfo));
		}
        public DataSet GetViewReceiptItemStatisticbySupplier(int SupplierID, DateTime Fromday, DateTime Todate)
        {
            string strQuery = string.Format(@"SELECT dbo.ICReceipts.FK_APSupplierID AS FK_APSupplierID,
												   dbo.ICReceipts.FK_GECurrencyID AS FK_GECurencyID,
	                                               dbo.ICReceipts.ICReceiptNo AS ViewReceiptStatisticNo,
	                                               dbo.ICReceipts.ICReceiptDate AS ViewReceiptStatisticDate,
	                                               dbo.ICReceiptItems.FK_ICProductID AS FK_ICProductID,
	                                               dbo.ICReceiptItems.ICReceiptItemQty AS ViewReceiptStatisticItemQty,
	                                               dbo.ICReceiptItems.ICReceiptItemRQty AS ViewReceiptStatisticItemRQty,
	                                               dbo.ICReceiptItems.ICReceiptItemQty- dbo.ICReceiptItems.ICReceiptItemRQty AS ViewReceiptStatisticItemInvQty,
	                                               dbo.ICReceiptItems.ICReceiptItemFUnitPrice AS ViewReceiptStatisticItemFUnitPrice,
                                                   dbo.ICReceiptItems.ICReceiptItemFPrice AS ViewReceiptStatisticItemFPrice,
                                                   dbo.ICReceiptItems.ICReceiptItemFTxAmt AS ViewReceiptStatisticItemFTaxAmt,
                                                   dbo.ICReceiptItems.ICReceiptItemFAmtTot AS ViewReceiptStatisticItemFAmtTot,
                                                    dbo.ICReceiptItems.ICReceiptItemID AS FK_ICReceiptItemID
                                                    ,dbo.ICReceiptItems.FK_ICUOMID as FK_ICUOMID
                                            FROM dbo.ICReceipts INNER JOIN dbo.ICReceiptItems ON ICReceiptID = FK_ICReceiptID
                                            WHERE 
                                                    dbo.ICReceipts.AAStatus = 'Alive'
                                                    AND dbo.ICReceiptItems.AAStatus = 'Alive'
                                                    AND (FK_APSupplierID = {0} or {0}=0)
		                                            AND CONVERT(VARCHAR(10), [ICReceiptDate], 112)>= CONVERT(VARCHAR(10), '{1}', 112)
		                                            AND CONVERT(VARCHAR(10), [ICReceiptDate], 112)<=CONVERT(VARCHAR(10), '{2}', 112)", SupplierID, Fromday.ToString("yyyyMMdd"), Todate.ToString("yyyyMMdd"));
            DataSet ds =  dal.GetDataSet(strQuery);
            return ds;
        }
	}
	#endregion
}