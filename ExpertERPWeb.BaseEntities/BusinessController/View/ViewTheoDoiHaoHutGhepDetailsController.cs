using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ViewTheoDoiHaoHutDetails
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ViewDeAssemblyFollowUpDetailsController
	//Created Date:Wednesday, March 27, 2013
	//-----------------------------------------------------------

    public class ViewTheoDoiHaoHutGhepDetailsController : BaseBusinessController
	{
		public ViewTheoDoiHaoHutGhepDetailsController()
		{
            dal = new DALBaseProvider("ViewTheoDoiHaoHutGhepDetails", typeof(ViewTheoDoiHaoHutGhepDetailsInfo));
		}

        public DataSet GetAllDataCBMThoByColorSchemaAndProductAndProductFGAndInRange(int iProductColorSchemaID, int iProductID, int iProductFGID, DateTime dtDate, int iPhaseCfgID)
        {
            String strDate = DALUtil.GennerateCondition("PPProductionOrdrDate", CompareType.Equal, dtDate);
            String strQuery = String.Format(@"SELECT   NVL.ICProductID  AS FK_ICProductID,
					                                    ICShipmentItems.FK_ICProductIDWO AS FK_ICProductFGID,
					                                    ICShipmentItems.ICShipmentItemVolume AS ViewTheoDoiHaoHutGhepDetailCBM,
					                                    ICShipmentItems.ICShipmentItemQty AS ViewTheoDoiHaoHutGhepDetailQty,
					                                    ICShipmentItems.FK_PPProductionOrdrID,
					                                    ICShipmentItems.FK_PPWOID,
					                                    ICShipmentItems.FK_PPPhaseCfgID , 
					                                    PPProductionOrdrs.PPProductionOrdrDate AS ViewTheoDoiHaoHutGhepDetailDate
			                                    FROM         dbo.PPProductionOrdrs 
								                                      
								                                      INNER JOIN dbo.ICShipmentItems ON dbo.PPProductionOrdrs.PPProductionOrdrID = dbo.ICShipmentItems.FK_PPProductionOrdrID 
																	                                  
								                                      INNER JOIN dbo.ICProducts AS NVL ON  dbo.ICShipmentItems.FK_ICProductID = NVL.ICProductID 
								                                      
			                                    WHERE	PPProductionOrdrs.AAStatus='Alive'
					                                    AND ICShipmentItems.AAStatus='Alive'
					                                    AND ICShipmentItems.FK_PPPhaseCfgID={0}
					                                    AND NVL.FK_ICProductColorSchemaID={1}
					                                    AND NVL.ICProductID={2}
					                                    AND ICShipmentItems.FK_ICProductIDWO={3}
					                                    AND {4}
                                                ", iPhaseCfgID,iProductColorSchemaID,iProductID,iProductFGID,strDate);
            return GetDataSet(strQuery);
        }

        public DataSet GetAllDataCBMTinhByColorSchemaAndProductAndProductFGAndInRange( int iProductID, int iProductFGID, DateTime dtDate, int iPhaseCfgID)
        {
            String strDate = DALUtil.GennerateCondition("PPProductionOrdrDate", CompareType.Equal, dtDate);
            String strQuery = String.Format(@"SELECT      {1} AS FK_ICProductID,
                                                    ICReceiptItems.FK_ICProductID AS FK_ICProductFGID,
                                                    ICReceiptItems.ICReceiptItemVolume AS ViewTheoDoiHaoHutGhepDetailCBM,
                                                    ICReceiptItems.ICReceiptItemQty AS ViewTheoDoiHaoHutGhepDetailQty,
           
                                                    ICReceiptItems.FK_PPProductionOrdrID,
                                                    ICReceiptItems.FK_PPWOID,
                                                    ICReceiptItems.FK_PPPhaseCfgID , 
                                                    PPProductionOrdrs.PPProductionOrdrDate AS ViewTheoDoiHaoHutGhepDetailDate
                                                    
                                                        FROM         dbo.PPProductionOrdrs INNER JOIN
                                                                              dbo.ICReceiptItems ON dbo.PPProductionOrdrs.PPProductionOrdrID = dbo.ICReceiptItems.FK_PPProductionOrdrID 
                                                                              INNER JOIN dbo.ICProducts AS TP ON dbo.ICReceiptItems.FK_ICProductID = TP.ICProductID 
                                      
                                                        WHERE	PPProductionOrdrs.AAStatus='Alive'
                                                                AND ICReceiptItems.AAStatus='Alive'
                                                                AND ICReceiptItems.FK_PPPhaseCfgID={0}
                                                                AND TP.ICProductID={2}
                                                                 AND {3} 
                                                ", iPhaseCfgID, iProductID, iProductFGID, strDate);
            return GetDataSet(strQuery);
        }
    }
	#endregion
}