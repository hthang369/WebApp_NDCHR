using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
    #region ViewFieldAliass
    //-----------------------------------------------------------
    //Generated By: Expert Studio
    //Class:ViewFieldAliassController
    //Created Date:24 Tháng Tư 2013
    //-----------------------------------------------------------

    public class ViewFieldAliassController : BaseBusinessController
    {
        public ViewFieldAliassController()
        {
            dal = new DALBaseProvider("ViewFieldAliass", typeof(ViewFieldAliassInfo));
        }
        public DataSet GetDataByModuleNameAndTableName(string strModuleName, string strTableName)
        {
            string strQuery = string.Format(@"select Tag.STFieldText as ViewFieldAliasText,STFields.STFieldText as ViewFieldAliasFieldName
                                                    ,STFields.STFieldTableName as ViewFieldAliasTableName,STFields.STFieldDisplayMember as ViewFieldAliasDisplayMember
                                            from STFields inner join STFields as Tag on STFields.STFieldName=Tag.STFieldTag
                                            where STFields.STFieldDataSource='{1}'
                                            AND STFields.STUserGroupID=1 AND Tag.STUserGroupID=1
                                            AND STFields.STScreenID in 
	                                            (Select STScreenID from STScreens where STScreenTag='DM' AND STModuleID 
			                                            in (Select STModuleID from STModules where STModuleName='{0}'))
                                            AND Tag.STScreenID in 
	                                            (Select STScreenID from STScreens where STScreenTag='DM' AND STModuleID 
			                                            in (Select STModuleID from STModules where STModuleName='{0}'))
	                                            order by STFields.STFieldID", strModuleName, strTableName);
            return dal.GetDataSet(strQuery);
        }
    }
    #endregion
}