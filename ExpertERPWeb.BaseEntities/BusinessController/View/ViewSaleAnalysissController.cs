using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ViewSaleAnalysiss
	//-----------------------------------------------------------
	//Generated By: Expert Studio
	//Class:ViewSaleAnalysissController
	//Created Date:Friday, May 18, 2012
	//-----------------------------------------------------------
	
	public class ViewSaleAnalysissController:BaseBusinessController
	{
		public ViewSaleAnalysissController()
		{
			dal= new DALBaseProvider("ViewSaleAnalysiss",typeof(ViewSaleAnalysissInfo));
		}
        public DataSet GetDatasetByProductGroupProductAttrInRange(int iProductGroupID, string AttrName, DateTime FromDate, DateTime ToDate)
        {
            String strQuery = String.Format(@"SELECT ICProductAttrValue,SUM(ARInvoiceItemQty) AS ARInvoiceItemQty ,SUM(ARInvoiceItemAmtTot) AS ARInvoiceItemAmtTot
                                            FROM dbo.ARInvoices inner join ARInvoiceItems on ARInvoices.ARInvoiceID = ARInvoiceItems.FK_ARInvoiceID
                                                        Inner join ICProducts on ARInvoiceItems.FK_ICProductID=ICProducts.ICProductID
                                                        inner join ICProductAttrs on ICProducts.ICProductID=ICProductAttrs.FK_ICProductID
                                                        WHERE ARInvoices.AAStatus='Alive' AND ARInvoiceItems.AAStatus='Alive' AND ICProducts.AAStatus='Alive' AND ICProductAttrs.AAStatus='Alive'
	                                                    	AND FK_ICProductGroupID={0}
                                                            AND  ICProductAttrName='{1}'
                                                            AND CONVERT(VARCHAR(10), [ARInvoiceDate], 112)>= CONVERT(VARCHAR(10), '{2}', 112) 
                                                            AND CONVERT(VARCHAR(10), [ARInvoiceDate], 112)<= CONVERT(VARCHAR(10), '{3}', 112)
                                                            GROUP BY ICProductAttrValue 
                                                        ", iProductGroupID, AttrName, FromDate.ToString("yyyyMMdd"), ToDate.ToString("yyyyMMdd"));
            return dal.GetDataSet(strQuery);
        }
        public DataSet GetDatasetByProductGroupProductAttrInRange(int iProductGroupID, string AttrName, string AttrValue, string subAttrName, DateTime FromDate, DateTime ToDate)
        {
            String strQuery = String.Format(@"SELECT AttrLevel2.ICProductAttrValue,SUM(ARInvoiceItemQty) AS ARInvoiceItemQty ,SUM(ARInvoiceItemAmtTot) AS ARInvoiceItemAmtTot
                                            FROM dbo.ARInvoices inner join ARInvoiceItems on ARInvoices.ARInvoiceID = ARInvoiceItems.FK_ARInvoiceID
                                                        Inner join ICProducts on ARInvoiceItems.FK_ICProductID=ICProducts.ICProductID
                                                        inner join ICProductAttrs on ICProducts.ICProductID=ICProductAttrs.FK_ICProductID
                                                        inner join ICProductAttrs as AttrLevel2 on ICProducts.ICProductID=AttrLevel2.FK_ICProductID
                                                        WHERE ARInvoices.AAStatus='Alive' AND ARInvoiceItems.AAStatus='Alive' AND ICProducts.AAStatus='Alive' AND ICProductAttrs.AAStatus='Alive' AND AttrLevel2.AAStatus='Alive'
	                                                    	AND FK_ICProductGroupID={0}
                                                            AND  ICProductAttrs.ICProductAttrName='{1}' and ICProductAttrs.ICProductAttrValue='{2}'
                                                            AND AttrLevel2.ICProductAttrName='{5}'
                                                            AND CONVERT(VARCHAR(10), [ARInvoiceDate], 112)>= CONVERT(VARCHAR(10), '{3}', 112) 
                                                            AND CONVERT(VARCHAR(10), [ARInvoiceDate], 112)<= CONVERT(VARCHAR(10), '{4}', 112)
                                                            GROUP BY   AttrLevel2.ICProductAttrValue
                                                        ", iProductGroupID, AttrName, AttrValue, FromDate.ToString("yyyyMMdd"), ToDate.ToString("yyyyMMdd"), subAttrName);
            return dal.GetDataSet(strQuery);
        }

        public DataSet GetDatasetByProductGroupProductAttrInRange(int iProductGroupID, string AttrName, string AttrValue, string AttrNameLevel2,string AttrValueLevel2,string AttrNameLevel3, DateTime FromDate, DateTime ToDate)
        {
            String strQuery = String.Format(@"SELECT AttrLevel3.ICProductAttrValue,SUM(ARInvoiceItemQty) AS ARInvoiceItemQty ,SUM(ARInvoiceItemAmtTot) AS ARInvoiceItemAmtTot
                                            FROM dbo.ARInvoices inner join ARInvoiceItems on ARInvoices.ARInvoiceID = ARInvoiceItems.FK_ARInvoiceID
                                                        Inner join ICProducts on ARInvoiceItems.FK_ICProductID=ICProducts.ICProductID
                                                        inner join ICProductAttrs on ICProducts.ICProductID=ICProductAttrs.FK_ICProductID
                                                        inner join ICProductAttrs as AttrLevel2 on ICProducts.ICProductID=AttrLevel2.FK_ICProductID
                                                        inner join ICProductAttrs as AttrLevel3 on ICProducts.ICProductID=AttrLevel3.FK_ICProductID
                                                        WHERE ARInvoices.AAStatus='Alive' AND ARInvoiceItems.AAStatus='Alive' AND ICProducts.AAStatus='Alive' AND ICProductAttrs.AAStatus='Alive' AND AttrLevel2.AAStatus='Alive'
                                                            AND AttrLevel3.AAStatus='Alive'
	                                                    	AND FK_ICProductGroupID={0}
                                                            AND  ICProductAttrs.ICProductAttrName='{1}' and ICProductAttrs.ICProductAttrValue='{2}'
                                                            AND AttrLevel2.ICProductAttrName='{5}' AND AttrLevel2.ICProductAttrValue='{6}'
                                                            AND AttrLevel3.ICProductAttrName='{7}'
                                                            AND CONVERT(VARCHAR(10), [ARInvoiceDate], 112)>= CONVERT(VARCHAR(10), '{3}', 112) 
                                                            AND CONVERT(VARCHAR(10), [ARInvoiceDate], 112)<= CONVERT(VARCHAR(10), '{4}', 112)
                                                            GROUP BY   AttrLevel3.ICProductAttrValue
                                                        ", iProductGroupID, AttrName, AttrValue, FromDate.ToString("yyyyMMdd"), ToDate.ToString("yyyyMMdd"), AttrNameLevel2, AttrValueLevel2, AttrNameLevel3);
            return dal.GetDataSet(strQuery);
        }

        public DataSet GetDatasetByProductGroupProductAttrInRange(int iProductGroupID, string AttrName, string AttrValue, string AttrNameLevel2, string AttrValueLevel2, string AttrNameLevel3,string AttrValueLevel3,string AttrNameLevel4, DateTime FromDate, DateTime ToDate)
        {
            String strQuery = String.Format(@"SELECT AttrLevel4.ICProductAttrValue,SUM(ARInvoiceItemQty) AS ARInvoiceItemQty ,SUM(ARInvoiceItemAmtTot) AS ARInvoiceItemAmtTot
                                            FROM dbo.ARInvoices inner join ARInvoiceItems on ARInvoices.ARInvoiceID = ARInvoiceItems.FK_ARInvoiceID
                                                        Inner join ICProducts on ARInvoiceItems.FK_ICProductID=ICProducts.ICProductID
                                                        inner join ICProductAttrs on ICProducts.ICProductID=ICProductAttrs.FK_ICProductID
                                                        inner join ICProductAttrs as AttrLevel2 on ICProducts.ICProductID=AttrLevel2.FK_ICProductID
                                                        inner join ICProductAttrs as AttrLevel3 on ICProducts.ICProductID=AttrLevel3.FK_ICProductID
                                                        inner join ICProductAttrs as AttrLevel4 on ICProducts.ICProductID=AttrLevel4.FK_ICProductID
                                                        WHERE ARInvoices.AAStatus='Alive' AND ARInvoiceItems.AAStatus='Alive' AND ICProducts.AAStatus='Alive' AND ICProductAttrs.AAStatus='Alive' AND AttrLevel2.AAStatus='Alive'
                                                            AND AttrLevel3.AAStatus='Alive' AND AttrLevel4.AAStatus='Alive'
	                                                    	AND FK_ICProductGroupID={0}
                                                            AND  ICProductAttrs.ICProductAttrName='{1}' and ICProductAttrs.ICProductAttrValue='{2}'
                                                            AND AttrLevel2.ICProductAttrName='{5}' AND AttrLevel2.ICProductAttrValue='{6}'
                                                            AND AttrLevel3.ICProductAttrName='{7}' AND AttrLevel3.ICProductAttrValue='{8}'
                                                            AND AttrLevel4.ICProductAttrName='{9}'
                                                            AND CONVERT(VARCHAR(10), [ARInvoiceDate], 112)>= CONVERT(VARCHAR(10), '{3}', 112) 
                                                            AND CONVERT(VARCHAR(10), [ARInvoiceDate], 112)<= CONVERT(VARCHAR(10), '{4}', 112)
                                                            GROUP BY   AttrLevel4.ICProductAttrValue
                                                        ", iProductGroupID, AttrName, AttrValue, FromDate.ToString("yyyyMMdd"), ToDate.ToString("yyyyMMdd"), AttrNameLevel2, AttrValueLevel2, AttrNameLevel3, AttrValueLevel3, AttrNameLevel4);
            return dal.GetDataSet(strQuery);
        }
    }
	#endregion
}