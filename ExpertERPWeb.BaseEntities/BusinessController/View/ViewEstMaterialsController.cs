using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ViewEstMaterials
	//-----------------------------------------------------------
	//Generated By: Expert Studio
	//Class:ViewEstMaterialsController
	//Created Date:Tuesday, November 13, 2012
	//-----------------------------------------------------------
	
	public class ViewEstMaterialsController:BaseBusinessController
	{
		public ViewEstMaterialsController()
		{
			dal= new DALBaseProvider("ViewEstMaterials",typeof(ViewEstMaterialsInfo));
		}
        public DataSet GetAllProductInNormRM()
        {
            string strQuery = string.Format(@"select PPNormRMS.FK_ICProductID as FK_ICProductID,sum(ViewEstMaterialQty*PPNormRMS.PPNormRMQty) as ViewEstMaterialQty,PPSubMaterialGroups.FK_ICProductGroupID as FK_ICProductGroupID  from 
                                                ViewEstMaterials 
                                                inner join PPNorms on ViewEstMaterials.FK_ICProductID=PPNorms.FK_ICProductID
                                                inner join PPNormRMS on PPNorms.PPNormID=PPNormRMS.FK_PPNormID
                                                inner join ICProducts on ICProducts.ICProductID=PPNormRMS.FK_ICProductID
                                                inner join PPSubMaterialGroups on ICProducts.FK_ICProductGroupID=PPSubMaterialGroups.FK_ICProductGroupID
                                                where   ICProducts.AAStatus='Alive' 
                                                group by PPNormRMS.FK_ICProductID,PPSubMaterialGroups.FK_ICProductGroupID");
            return dal.GetDataSet(strQuery);
        }
        public DataSet GetAllProductInNormRMLevel2()
        {
            string strQuery = string.Format(@"select PPNormRMSLevel2.FK_ICProductID as FK_ICProductID,sum(ViewEstMaterialQty*PPNormRMS.PPNormRMQty*PPNormRMSLevel2.PPNormRMQty) as ViewEstMaterialQty from 
                                            ViewEstMaterials 
                                            inner join PPNorms on ViewEstMaterials.FK_ICProductID=PPNorms.FK_ICProductID
                                            inner join PPNormRMS on PPNorms.PPNormID=PPNormRMS.FK_PPNormID
                                            inner join PPNorms as PPNormsLevel2 on PPNormsLevel2.FK_ICProductID=PPNormRMS.FK_ICProductID
                                            inner join PPNormRMS as PPNormRMSLevel2 on PPNormRMSLevel2.FK_PPNormID=PPNormsLevel2.PPNormID
                                            inner join ICProducts on ICProducts.ICProductID=PPNormRMSLevel2.FK_ICProductID
                                            inner join PPSubMaterialGroups on ICProducts.FK_ICProductGroupID=PPSubMaterialGroups.FK_ICProductGroupID
                                            where   ICProducts.AAStatus='Alive' 
                                            group by PPNormRMSLevel2.FK_ICProductID");
            return dal.GetDataSet(strQuery);
        }
	}
	#endregion
}