using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ViewAnalysisOfAgings
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ViewAnalysisOfAgingsController
	//Created Date:05 Tháng Hai 2013
	//-----------------------------------------------------------
	
	public class ViewAnalysisOfAgingsController:BaseBusinessController
	{
		public ViewAnalysisOfAgingsController()
		{
			dal= new DALBaseProvider("ViewAnalysisOfAgings",typeof(ViewAnalysisOfAgingsInfo));
		}

        public DataSet GetDataPhanTichTuoiNo(int iSupplier, DateTime dtAgingOffDate, String[] strAccountNo
            ,DateTime dtBefore1From,DateTime dtBefore1To
                ,DateTime dtBefore2From,DateTime dtBefore2To
                ,DateTime  dtBefore3From,DateTime  dtBefore3To
                ,DateTime  dtBefore4From,DateTime  dtBefore4To
                ,DateTime dtOverDue1From,DateTime dtOverDue1To
                , DateTime dtOverDue2From, DateTime dtOverDue2To
                , DateTime dtOverDue3From, DateTime dtOverDue3To
                , DateTime dtOverDue4From, DateTime dtOverDue4To)
        {
            #region Init  strAccount

            String strAccount = "";
            foreach (String strAcc in strAccountNo)
            {
                if (strAcc == "")
                    continue;
                if (strAccount == "")
                {
                    strAccount = String.Format(@"FK_GLCreditAccountID IN (SELECT GLAccountID FROM GLAccounts WHERE AAStatus='Alive' AND (GLAccountNo LIKE '{0}%' ", strAcc);
                }
                else
                {
                    strAccount += String.Format(@" OR GLAccountNo LIKE '{0}%' ", strAcc);
                }
            }
            if (strAccount != "")
                strAccount += "))";


            #endregion

            #region Init Range Date
            String strBeforePInvoice=DALUtil.GenerateBeetween("APPInvoiceExpireDate",DateTime.MinValue,DateTime.MaxValue);
            String strBeforePO = DALUtil.GenerateBeetween("APPOExpireDate", DateTime.MinValue, DateTime.MaxValue);
            String strBeforeVoucher = DALUtil.GenerateBeetween("GLVoucherItemDueDate", DateTime.MinValue, DateTime.MaxValue);

            String strBefore1PInvoice=DALUtil.GenerateBeetween("APPInvoiceExpireDate",dtBefore1From,dtBefore1To);
            String strBefore1PO=DALUtil.GenerateBeetween("APPOExpireDate",dtBefore1From,dtBefore1To);
            String strBefore1Voucher=DALUtil.GenerateBeetween("GLVoucherItemDueDate",dtBefore1From,dtBefore1To);

            String strBefore2PInvoice=DALUtil.GenerateBeetween("APPInvoiceExpireDate",dtBefore2From,dtBefore2To);
            String strBefore2PO=DALUtil.GenerateBeetween("APPOExpireDate",dtBefore2From,dtBefore2To);
            String strBefore2Voucher=DALUtil.GenerateBeetween("GLVoucherItemDueDate",dtBefore2From,dtBefore2To);

            String strBefore3PInvoice=DALUtil.GenerateBeetween("APPInvoiceExpireDate",dtBefore3From,dtBefore3To);
            String strBefore3PO=DALUtil.GenerateBeetween("APPOExpireDate",dtBefore3From,dtBefore3To);
            String strBefore3Voucher=DALUtil.GenerateBeetween("GLVoucherItemDueDate",dtBefore3From,dtBefore3To);

            String strBefore4PInvoice=DALUtil.GenerateBeetween("APPInvoiceExpireDate",dtBefore4From,dtBefore4To);
            String strBefore4PO=DALUtil.GenerateBeetween("APPOExpireDate",dtBefore4From,dtBefore4To);
            String strBefore4Voucher=DALUtil.GenerateBeetween("GLVoucherItemDueDate",dtBefore4From,dtBefore4To);
            
            String strOverDue1PInvoice=DALUtil.GenerateBeetween("APPInvoiceExpireDate",dtOverDue1From,dtOverDue1To);
            String strOverDue1PO=DALUtil.GenerateBeetween("APPOExpireDate",dtOverDue1From,dtOverDue1To);
            String strOverDue1Voucher=DALUtil.GenerateBeetween("GLVoucherItemDueDate",dtOverDue1From,dtOverDue1To);
            
            String strOverDue2PInvoice=DALUtil.GenerateBeetween("APPInvoiceExpireDate",dtOverDue2From,dtOverDue2To);
            String strOverDue2PO=DALUtil.GenerateBeetween("APPOExpireDate",dtOverDue2From,dtOverDue2To);
            String strOverDue2Voucher=DALUtil.GenerateBeetween("GLVoucherItemDueDate",dtOverDue2From,dtOverDue2To);

            String strOverDue3PInvoice=DALUtil.GenerateBeetween("APPInvoiceExpireDate",dtOverDue3From,dtOverDue3To);
            String strOverDue3PO=DALUtil.GenerateBeetween("APPOExpireDate",dtOverDue3From,dtOverDue3To);
            String strOverDue3Voucher=DALUtil.GenerateBeetween("GLVoucherItemDueDate",dtOverDue3From,dtOverDue3To);

            String strOverDue4PInvoice=DALUtil.GenerateBeetween("APPInvoiceExpireDate",dtOverDue4From,dtOverDue4To);
            String strOverDue4PO=DALUtil.GenerateBeetween("APPOExpireDate",dtOverDue4From,dtOverDue4To);
            String strOverDue4Voucher=DALUtil.GenerateBeetween("GLVoucherItemDueDate",dtOverDue4From,dtOverDue4To);

            String strBeforeOverDue4PInvoice = DALUtil.GenerateBeetween("APPInvoiceExpireDate", DateTime.MinValue, dtOverDue4From.AddDays(-1));
            String strBeforeOverDue4PO = DALUtil.GenerateBeetween("APPOExpireDate", DateTime.MinValue, dtOverDue4From.AddDays(-1));
            String strBeforeOverDue4Voucher = DALUtil.GenerateBeetween("GLVoucherItemDueDate", DateTime.MinValue, dtOverDue4From.AddDays(-1));

            String strAfterBefore4PInvoice = DALUtil.GenerateBeetween("APPInvoiceExpireDate", dtBefore4To.AddDays(1), DateTime.MaxValue);
            String strAfterBefore4PO = DALUtil.GenerateBeetween("APPOExpireDate", dtBefore4To.AddDays(1), DateTime.MaxValue);
            String strAfterBefore4Voucher = DALUtil.GenerateBeetween("GLVoucherItemDueDate", dtBefore4To.AddDays(1), DateTime.MaxValue);
            #endregion

            #region ---Câu Query 1 : Lấy dữ liệu cho các field AmtTot,RemainAmtTot,RcpAmtTot,PmtReqAmtTot bằng cách UNION 3 cấu query con ở 3 table PInvoice,PO,Voucher.
            String strQuery1 = String.Format(@"
        -----------------------AmtTot,RemainAmtTot,RcpAmtTot,PmtReqAmtTot-------------------------------------------------
        SELECT SUM(AmtTot) AS AmtTot,
        SUM(RemainAmtTot) AS RemainAmtTot,
        SUM(RcpAmtTot) AS RcpAmtTot,
        0 AS Before1,
        0 AS Before2,
        0 AS Before3,
        0 AS Before4,
        0 AS OverDue1,
        0 AS OverDue2,
        0 AS OverDue3,
        0 AS OverDue4,
        0 AS BeforeOverDue4,
        0 AS AfterBefore4,
        SUM(PmtReqAmtTot) AS PmtReqAmtTot,
        FK_APSupplierID AS FK_APSupplierID,
        GETDATE() AS AgingOffDate
        FROM 
        (
            ---Lấy dữ liệu cho các field AmtTot,RemainAmtTot,RcpAmtTot,PmtReqAmtTot ở table PInvoice
		    -------------------PInvoice-----------------
		    SELECT 
		    SUM(APPInvoiceFAmtTot) AS AmtTot,
		    SUM(APPInvoiceRFAmtTot) AS RemainAmtTot,
		    (SUM(APPInvoiceFAmtTot)-SUM(APPInvoiceRFAmtTot)) AS RcpAmtTot,
		    SUM(APPInvoicePmtReqFAmtTot) AS PmtReqAmtTot,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPInvoices ON dbo.APSuppliers.APSupplierID = dbo.APPInvoices.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPInvoices.AAStatus='Alive'
            AND APPInvoiceRFAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPInvoiceExpireDate IS NOT NULL AND {3}
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
		     ---Lấy dữ liệu cho các field AmtTot,RemainAmtTot,RcpAmtTot,PmtReqAmtTot ở table PO
		    -------------------PO-----------------
		    SELECT 
		    SUM(APPOFAmtTot  * APPOHaveToPayPct / 100) AS AmtTot,
		    SUM(APPOFRAmtTot) AS RemainAmtTot,
		    (SUM(APPOFAmtTot * APPOHaveToPayPct / 100)-SUM(APPOFRAmtTot)) AS RcpAmtTot,
		    SUM(APPOPmtReqFAmtTot) AS PmtReqAmtTot,
		    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPOs ON dbo.APSuppliers.APSupplierID = dbo.APPOs.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPOs.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPOExpireDate IS NOT NULL AND {4} AND APPOHaveToPayPct>0 AND APPOFRAmtTot>0
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
            ---Lấy dữ liệu cho các field AmtTot,RemainAmtTot,RcpAmtTot,PmtReqAmtTot ở table Voucher
		    -------------------Voucher-----------------
		    SELECT 
		    SUM(GLVoucherFAmtTot) AS AmtTot,
		    SUM(GLVoucherRFAmtTot) AS RemainAmtTot,
		    (SUM(GLVoucherFAmtTot)-SUM(GLVoucherRFAmtTot)) AS RcpAmtTot,
		    SUM(GLVoucherPmtReqFAmtTot) AS PmtReqAmtTot,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.GLVouchers ON dbo.APSuppliers.APSupplierID = dbo.GLVouchers.FK_APSupplierID
		    INNER JOIN dbo.GLVoucherItems ON dbo.GLVouchers.GLVoucherID = dbo.GLVoucherItems.FK_GLVoucherID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND GLVouchers.AAStatus='Alive'
            AND GLVouchers.GLVoucherRAmtTot>0
		    AND GLVoucherItems.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND GLVoucherItems.GLVoucherItemDueDate IS NOT NULL AND {5} AND {2}
		    GROUP BY APSuppliers.APSupplierID

        ) AS PmtReqAmtTot
        GROUP BY FK_APSupplierID", iSupplier, dtAgingOffDate.ToString("yyyyMMdd"), strAccount
 , strBeforePInvoice, strBeforePO, strBeforeVoucher);
            #endregion

            #region ---Câu Query 2 : Lấy dữ liệu cho Before1 bằng cách UNION 3 cấu query con ở 3 table PInvoice,PO,Voucher.
            String strQuery2 = String.Format(@"
        -----------------------Before1-------------------------------------------------
        SELECT 0 AS AmtTot,
        0 AS RemainAmtTot,
        0 AS RcpAmtTot,
        SUM(Before1) AS Before1,
        0 AS Before2,
        0 AS Before3,
        0 AS Before4,
        0 AS OverDue1,
        0 AS OverDue2,
        0 AS OverDue3,
        0 AS OverDue4,
        0 AS BeforeOverDue4,
        0 AS AfterBefore4,
        0 AS PmtReqAmtTot,
        FK_APSupplierID AS FK_APSupplierID,
        GETDATE() AS AgingOffDate
        FROM 
        (
            ---Lấy dữ liệu cho Before1 ở table PInvoice
		    -------------------PInvoice-----------------
		    SELECT SUM(APPInvoiceRFAmtTot) AS Before1,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPInvoices ON dbo.APSuppliers.APSupplierID = dbo.APPInvoices.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPInvoices.AAStatus='Alive'
            AND APPInvoiceRFAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPInvoiceExpireDate IS NOT NULL AND {3}
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
		    ---Lấy dữ liệu cho Before1 ở table PO
		    -------------------PO-----------------
		    SELECT SUM(APPOFRAmtTot) AS Before1,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPOs ON dbo.APSuppliers.APSupplierID = dbo.APPOs.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPOs.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPOExpireDate IS NOT NULL AND {4} AND APPOHaveToPayPct>0 AND APPOFRAmtTot>0
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
            ---Lấy dữ liệu cho Before1 ở table Voucher
		    -------------------Voucher-----------------
		    SELECT SUM(GLVoucherRFAmtTot) AS Before1,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.GLVouchers ON dbo.APSuppliers.APSupplierID = dbo.GLVouchers.FK_APSupplierID
		    INNER JOIN dbo.GLVoucherItems ON dbo.GLVouchers.GLVoucherID = dbo.GLVoucherItems.FK_GLVoucherID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND GLVouchers.AAStatus='Alive'
		    AND GLVoucherItems.AAStatus='Alive'
            AND GLVouchers.GLVoucherRAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND GLVoucherItems.GLVoucherItemDueDate IS NOT NULL AND {5} AND {2}
		    GROUP BY APSuppliers.APSupplierID

        ) AS Before1
        GROUP BY FK_APSupplierID", iSupplier, dtAgingOffDate.ToString("yyyyMMdd"), strAccount
 , strBefore1PInvoice, strBefore1PO, strBefore1Voucher);
            #endregion

            #region ---Câu Query 3 : Lấy dữ liệu cho Before2 bằng cách UNION 3 cấu query con ở 3 table PInvoice,PO,Voucher.
            String strQuery3 = String.Format(@"
        -----------------------Before2-------------------------------------------------
        SELECT 0 AS AmtTot,
        0 AS RemainAmtTot,
        0 AS RcpAmtTot,
        0 AS Before1,
        SUM(Before2) AS Before2,
        0 AS Before3,
        0 AS Before4,
        0 AS OverDue1,
        0 AS OverDue2,
        0 AS OverDue3,
        0 AS OverDue4,
        0 AS BeforeOverDue4,
        0 AS AfterBefore4,
        0 AS PmtReqAmtTot,
        FK_APSupplierID AS FK_APSupplierID,
        GETDATE() AS AgingOffDate
        FROM 
        (
            ---Lấy dữ liệu cho Before2 ở table PInvoice
		    -------------------PInvoice-----------------
		    SELECT SUM(APPInvoiceRFAmtTot) AS Before2,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPInvoices ON dbo.APSuppliers.APSupplierID = dbo.APPInvoices.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPInvoices.AAStatus='Alive'
            AND APPInvoiceRFAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPInvoiceExpireDate IS NOT NULL AND {3}
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
		    ---Lấy dữ liệu cho Before2 ở table PO
		    -------------------PO-----------------
		    SELECT SUM(APPOFRAmtTot) AS Before2,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPOs ON dbo.APSuppliers.APSupplierID = dbo.APPOs.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPOs.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPOExpireDate IS NOT NULL AND {4} AND APPOHaveToPayPct>0 AND APPOFRAmtTot>0
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
            ---Lấy dữ liệu cho Before2 ở table Voucher
		    -------------------Voucher-----------------
		    SELECT SUM(GLVoucherRFAmtTot) AS Before2,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.GLVouchers ON dbo.APSuppliers.APSupplierID = dbo.GLVouchers.FK_APSupplierID
		    INNER JOIN dbo.GLVoucherItems ON dbo.GLVouchers.GLVoucherID = dbo.GLVoucherItems.FK_GLVoucherID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND GLVouchers.AAStatus='Alive'
		    AND GLVoucherItems.AAStatus='Alive'
            AND GLVouchers.GLVoucherRAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND GLVoucherItems.GLVoucherItemDueDate IS NOT NULL AND {5} AND {2}
		    GROUP BY APSuppliers.APSupplierID

        ) AS Before2
        GROUP BY FK_APSupplierID", iSupplier, dtAgingOffDate.ToString("yyyyMMdd"), strAccount
 , strBefore2PInvoice, strBefore2PO, strBefore2Voucher);
            #endregion

            #region ---Câu Query 4 : Lấy dữ liệu cho Before3 bằng cách UNION 3 cấu query con ở 3 table PInvoice,PO,Voucher.
            String strQuery4 = String.Format(@"
        -----------------------Before3-------------------------------------------------
        SELECT 0 AS AmtTot,
        0 AS RemainAmtTot,
        0 AS RcpAmtTot,
        0 AS Before1,
        0 AS Before2,
        SUM(Before3) AS Before3,
        0 AS Before4,
        0 AS OverDue1,
        0 AS OverDue2,
        0 AS OverDue3,
        0 AS OverDue4,
        0 AS BeforeOverDue4,
        0 AS AfterBefore4,
        0 AS PmtReqAmtTot,
        FK_APSupplierID AS FK_APSupplierID,
        GETDATE() AS AgingOffDate
        FROM 
        (
            ---Lấy dữ liệu cho Before3 ở table PInvoice
		    -------------------PInvoice-----------------
		    SELECT SUM(APPInvoiceRFAmtTot) AS Before3,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPInvoices ON dbo.APSuppliers.APSupplierID = dbo.APPInvoices.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPInvoices.AAStatus='Alive'
            AND APPInvoiceRFAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPInvoiceExpireDate IS NOT NULL AND {3}
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
		    ---Lấy dữ liệu cho Before3 ở table PO
		    -------------------PO-----------------
		    SELECT SUM(APPOFRAmtTot) AS Before3,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPOs ON dbo.APSuppliers.APSupplierID = dbo.APPOs.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPOs.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPOExpireDate IS NOT NULL AND {4} AND APPOHaveToPayPct>0 AND APPOFRAmtTot>0
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
            ---Lấy dữ liệu cho Before3 ở table Voucher
		    -------------------Voucher-----------------
		    SELECT SUM(GLVoucherRFAmtTot) AS Before3,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.GLVouchers ON dbo.APSuppliers.APSupplierID = dbo.GLVouchers.FK_APSupplierID
		    INNER JOIN dbo.GLVoucherItems ON dbo.GLVouchers.GLVoucherID = dbo.GLVoucherItems.FK_GLVoucherID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND GLVouchers.AAStatus='Alive'
		    AND GLVoucherItems.AAStatus='Alive'
            AND GLVouchers.GLVoucherRAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND GLVoucherItems.GLVoucherItemDueDate IS NOT NULL AND {5} AND {2}
		    GROUP BY APSuppliers.APSupplierID

        ) AS Before3
        GROUP BY FK_APSupplierID", iSupplier, dtAgingOffDate.ToString("yyyyMMdd"), strAccount
 , strBefore3PInvoice, strBefore3PO, strBefore3Voucher);
            #endregion

            #region ---Câu Query 5 : Lấy dữ liệu cho Before4 bằng cách UNION 3 cấu query con ở 3 table PInvoice,PO,Voucher.
            String strQuery5 = String.Format(@"
        -----------------------Before4-------------------------------------------------
        SELECT 0 AS AmtTot,
        0 AS RemainAmtTot,
        0 AS RcpAmtTot,
        0 AS Before1,
        0 AS Before2,
        0 AS Before3,
        SUM(Before4) AS Before4,
        0 AS OverDue1,
        0 AS OverDue2,
        0 AS OverDue3,
        0 AS OverDue4,
        0 AS BeforeOverDue4,
        0 AS AfterBefore4,
        0 AS PmtReqAmtTot,
        FK_APSupplierID AS FK_APSupplierID,
        GETDATE() AS AgingOffDate
        FROM 
        (
            ---Lấy dữ liệu cho Before4 ở table PInvoice
		    -------------------PInvoice-----------------
		    SELECT SUM(APPInvoiceRFAmtTot) AS Before4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPInvoices ON dbo.APSuppliers.APSupplierID = dbo.APPInvoices.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPInvoices.AAStatus='Alive'
            AND APPInvoiceRFAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPInvoiceExpireDate IS NOT NULL AND {3}
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
		    ---Lấy dữ liệu cho Before4 ở table PO
		    -------------------PO-----------------
		    SELECT SUM(APPOFRAmtTot) AS Before4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPOs ON dbo.APSuppliers.APSupplierID = dbo.APPOs.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPOs.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPOExpireDate IS NOT NULL AND {4} AND APPOHaveToPayPct>0 AND APPOFRAmtTot>0
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
            ---Lấy dữ liệu cho Before4 ở table Voucher
		    -------------------Voucher-----------------
		    SELECT SUM(GLVoucherRFAmtTot) AS Before4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.GLVouchers ON dbo.APSuppliers.APSupplierID = dbo.GLVouchers.FK_APSupplierID
		    INNER JOIN dbo.GLVoucherItems ON dbo.GLVouchers.GLVoucherID = dbo.GLVoucherItems.FK_GLVoucherID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND GLVouchers.AAStatus='Alive'
		    AND GLVoucherItems.AAStatus='Alive'
            AND GLVouchers.GLVoucherRAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND GLVoucherItems.GLVoucherItemDueDate IS NOT NULL AND {5} AND {2}
		    GROUP BY APSuppliers.APSupplierID

        ) AS Before4
        GROUP BY FK_APSupplierID", iSupplier, dtAgingOffDate.ToString("yyyyMMdd"), strAccount
 , strBefore4PInvoice, strBefore4PO, strBefore4Voucher);
            #endregion

            #region ---Câu Query 6 : Lấy dữ liệu cho OverDue1 bằng cách UNION 3 cấu query con ở 3 table PInvoice,PO,Voucher.
            String strQuery6 = String.Format(@"
        -----------------------OverDue1-------------------------------------------------
        SELECT 0 AS AmtTot,
        0 AS RemainAmtTot,
        0 AS RcpAmtTot,
        0 AS Before1,
        0 AS Before2,
        0 AS Before3,
        0 AS Before4,
        SUM(OverDue1) AS OverDue1,
        0 AS OverDue2,
        0 AS OverDue3,
        0 AS OverDue4,
        0 AS BeforeOverDue4,
        0 AS AfterBefore4,
        0 AS PmtReqAmtTot,
        FK_APSupplierID AS FK_APSupplierID,
        GETDATE() AS AgingOffDate
        FROM 
        (
            ---Lấy dữ liệu cho OverDue1 ở table PInvoice
		    -------------------PInvoice-----------------
		    SELECT SUM(APPInvoiceRFAmtTot) AS OverDue1,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPInvoices ON dbo.APSuppliers.APSupplierID = dbo.APPInvoices.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPInvoices.AAStatus='Alive'
            AND APPInvoiceRFAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPInvoiceExpireDate IS NOT NULL AND {3}
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
		    ---Lấy dữ liệu cho OverDue1 ở table PO
		    -------------------PO-----------------
		    SELECT SUM(APPOFRAmtTot) AS OverDue1,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPOs ON dbo.APSuppliers.APSupplierID = dbo.APPOs.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPOs.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPOExpireDate IS NOT NULL AND {4} AND APPOHaveToPayPct>0 AND APPOFRAmtTot>0
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
            ---Lấy dữ liệu cho OverDue1 ở table Voucher
		    -------------------Voucher-----------------
		    SELECT SUM(GLVoucherRFAmtTot) AS OverDue1,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.GLVouchers ON dbo.APSuppliers.APSupplierID = dbo.GLVouchers.FK_APSupplierID
		    INNER JOIN dbo.GLVoucherItems ON dbo.GLVouchers.GLVoucherID = dbo.GLVoucherItems.FK_GLVoucherID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND GLVouchers.AAStatus='Alive'
		    AND GLVoucherItems.AAStatus='Alive'
            AND GLVouchers.GLVoucherRAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND GLVoucherItems.GLVoucherItemDueDate IS NOT NULL AND {5} AND {2}
		    GROUP BY APSuppliers.APSupplierID

        ) AS OverDue1
        GROUP BY FK_APSupplierID", iSupplier, dtAgingOffDate.ToString("yyyyMMdd"), strAccount
 , strOverDue1PInvoice, strOverDue1PO, strOverDue1Voucher);
            #endregion

            #region ---Câu Query 7 : Lấy dữ liệu cho OverDue2 bằng cách UNION 3 cấu query con ở 3 table PInvoice,PO,Voucher.
            String strQuery7 = String.Format(@"
       -----------------------OverDue2-------------------------------------------------
        SELECT 0 AS AmtTot,
        0 AS RemainAmtTot,
        0 AS RcpAmtTot,
        0 AS Before1,
        0 AS Before2,
        0 AS Before3,
        0 AS Before4,
        0 AS OverDue1,
        SUM(OverDue2) AS OverDue2,
        0 AS OverDue3,
        0 AS OverDue4,
        0 AS BeforeOverDue4,
        0 AS AfterBefore4,
        0 AS PmtReqAmtTot,
        FK_APSupplierID AS FK_APSupplierID,
        GETDATE() AS AgingOffDate
        FROM 
        (
            ---Lấy dữ liệu cho OverDue2 ở table PInvoice
		    -------------------PInvoice-----------------
		    SELECT SUM(APPInvoiceRFAmtTot) AS OverDue2,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPInvoices ON dbo.APSuppliers.APSupplierID = dbo.APPInvoices.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPInvoices.AAStatus='Alive'
            AND APPInvoiceRFAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPInvoiceExpireDate IS NOT NULL AND {3}
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
		    ---Lấy dữ liệu cho OverDue2 ở table PO
		    -------------------PO-----------------
		    SELECT SUM(APPOFRAmtTot) AS OverDue2,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPOs ON dbo.APSuppliers.APSupplierID = dbo.APPOs.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPOs.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPOExpireDate IS NOT NULL AND {4} AND APPOHaveToPayPct>0 AND APPOFRAmtTot>0
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
            ---Lấy dữ liệu cho OverDue2 ở table Voucher
		    -------------------Voucher-----------------
		    SELECT SUM(GLVoucherRFAmtTot) AS OverDue2,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.GLVouchers ON dbo.APSuppliers.APSupplierID = dbo.GLVouchers.FK_APSupplierID
		    INNER JOIN dbo.GLVoucherItems ON dbo.GLVouchers.GLVoucherID = dbo.GLVoucherItems.FK_GLVoucherID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND GLVouchers.AAStatus='Alive'
		    AND GLVoucherItems.AAStatus='Alive'
            AND GLVouchers.GLVoucherRAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND GLVoucherItems.GLVoucherItemDueDate IS NOT NULL AND {5} AND {2}
		    GROUP BY APSuppliers.APSupplierID

        ) AS OverDue2
        GROUP BY FK_APSupplierID", iSupplier, dtAgingOffDate.ToString("yyyyMMdd"), strAccount
 , strOverDue2PInvoice, strOverDue2PO, strOverDue2Voucher);
            #endregion

            #region ---Câu Query 8 : Lấy dữ liệu cho OverDue3 bằng cách UNION 3 cấu query con ở 3 table PInvoice,PO,Voucher.
            String strQuery8 = String.Format(@"
       -----------------------OverDue3-------------------------------------------------
        SELECT 0 AS AmtTot,
        0 AS RemainAmtTot,
        0 AS RcpAmtTot,
        0 AS Before1,
        0 AS Before2,
        0 AS Before3,
        0 AS Before4,
        0 AS OverDue1,
        0 AS OverDue2,
        SUM(OverDue3) AS OverDue3,
        0 AS OverDue4,
        0 AS BeforeOverDue4,
        0 AS AfterBefore4,
        0 AS PmtReqAmtTot,
        FK_APSupplierID AS FK_APSupplierID,
        GETDATE() AS AgingOffDate
        FROM 
        (
            ---Lấy dữ liệu cho OverDue3 ở table PInvoice	
		    -------------------PInvoice-----------------
		    SELECT SUM(APPInvoiceRFAmtTot) AS OverDue3,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPInvoices ON dbo.APSuppliers.APSupplierID = dbo.APPInvoices.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPInvoices.AAStatus='Alive'
            AND APPInvoiceRFAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPInvoiceExpireDate IS NOT NULL AND {3}
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
		    ---Lấy dữ liệu cho OverDue3 ở table PO
		    -------------------PO-----------------
		    SELECT SUM(APPOFRAmtTot) AS OverDue3,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPOs ON dbo.APSuppliers.APSupplierID = dbo.APPOs.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPOs.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPOExpireDate IS NOT NULL AND {4} AND APPOHaveToPayPct>0 AND APPOFRAmtTot>0
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
            ---Lấy dữ liệu cho OverDue3 ở table Voucher
		    -------------------Voucher-----------------
		    SELECT SUM(GLVoucherRFAmtTot) AS OverDue3,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.GLVouchers ON dbo.APSuppliers.APSupplierID = dbo.GLVouchers.FK_APSupplierID
		    INNER JOIN dbo.GLVoucherItems ON dbo.GLVouchers.GLVoucherID = dbo.GLVoucherItems.FK_GLVoucherID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND GLVouchers.AAStatus='Alive'
		    AND GLVoucherItems.AAStatus='Alive'
            AND GLVouchers.GLVoucherRAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND GLVoucherItems.GLVoucherItemDueDate IS NOT NULL AND {5} AND {2}
		    GROUP BY APSuppliers.APSupplierID

        ) AS OverDue3
        GROUP BY FK_APSupplierID", iSupplier, dtAgingOffDate.ToString("yyyyMMdd"), strAccount
 , strOverDue3PInvoice, strOverDue3PO, strOverDue3Voucher);
            #endregion

            #region ---Câu Query 9 : Lấy dữ liệu cho OverDue4 bằng cách UNION 3 cấu query con ở 3 table PInvoice,PO,Voucher.
            String strQuery9 = String.Format(@"
       -----------------------OverDue4-------------------------------------------------
        SELECT 0 AS AmtTot,
        0 AS RemainAmtTot,
        0 AS RcpAmtTot,
        0 AS Before1,
        0 AS Before2,
        0 AS Before3,
        0 AS Before4,
        0 AS OverDue1,
        0 AS OverDue2,
        0 AS OverDue3,
        SUM(OverDue4) AS OverDue4,
        0 AS BeforeOverDue4,
        0 AS AfterBefore4,
        0 AS PmtReqAmtTot,
        FK_APSupplierID AS FK_APSupplierID,
        GETDATE() AS AgingOffDate
        FROM 
        (
            ---Lấy dữ liệu cho OverDue4 ở table PInvoice	
		    -------------------PInvoice-----------------
		    SELECT SUM(APPInvoiceRFAmtTot) AS OverDue4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPInvoices ON dbo.APSuppliers.APSupplierID = dbo.APPInvoices.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPInvoices.AAStatus='Alive'
            AND APPInvoiceRFAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPInvoiceExpireDate IS NOT NULL AND {3}
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
		    ---Lấy dữ liệu cho OverDue4 ở table PO
		    -------------------PO-----------------
		    SELECT SUM(APPOFRAmtTot) AS OverDue4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPOs ON dbo.APSuppliers.APSupplierID = dbo.APPOs.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPOs.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPOExpireDate IS NOT NULL AND {4} AND APPOHaveToPayPct>0 AND APPOFRAmtTot>0
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
            ---Lấy dữ liệu cho OverDue4 ở table Voucher
		    -------------------Voucher-----------------
		    SELECT SUM(GLVoucherRFAmtTot) AS OverDue4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.GLVouchers ON dbo.APSuppliers.APSupplierID = dbo.GLVouchers.FK_APSupplierID
		    INNER JOIN dbo.GLVoucherItems ON dbo.GLVouchers.GLVoucherID = dbo.GLVoucherItems.FK_GLVoucherID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND GLVouchers.AAStatus='Alive'
		    AND GLVoucherItems.AAStatus='Alive'
            AND GLVouchers.GLVoucherRAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND GLVoucherItems.GLVoucherItemDueDate IS NOT NULL AND {5} AND {2}
		    GROUP BY APSuppliers.APSupplierID

        ) AS OverDue4
        GROUP BY FK_APSupplierID", iSupplier, dtAgingOffDate.ToString("yyyyMMdd"), strAccount
 , strOverDue4PInvoice, strOverDue4PO, strOverDue4Voucher);
            #endregion

            #region ---Câu Query 10 : Lấy dữ liệu cho BeforeOverDue4 bằng cách UNION 3 cấu query con ở 3 table PInvoice,PO,Voucher.
            String strQuery10 = String.Format(@"
       -----------------------BeforeOverDue4-------------------------------------------------
        SELECT 0 AS AmtTot,
        0 AS RemainAmtTot,
        0 AS RcpAmtTot,
        0 AS Before1,
        0 AS Before2,
        0 AS Before3,
        0 AS Before4,
        0 AS OverDue1,
        0 AS OverDue2,
        0 AS OverDue3,
        0 AS OverDue4,
        SUM(BeforeOverDue4) AS BeforeOverDue4,
        0 AS AfterBefore4,
        0 AS PmtReqAmtTot,
        FK_APSupplierID AS FK_APSupplierID,
        GETDATE() AS AgingOffDate
        FROM 
        (
            ---Lấy dữ liệu cho BeforeOverDue4 ở table PInvoice		    
            -------------------PInvoice-----------------
		    SELECT SUM(APPInvoiceRFAmtTot) AS BeforeOverDue4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPInvoices ON dbo.APSuppliers.APSupplierID = dbo.APPInvoices.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPInvoices.AAStatus='Alive'
            AND APPInvoiceRFAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPInvoiceExpireDate IS NOT NULL AND {3}
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
		    ---Lấy dữ liệu cho BeforeOverDue4 ở table PO
		    -------------------PO-----------------
		    SELECT SUM(APPOFRAmtTot) AS BeforeOverDue4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPOs ON dbo.APSuppliers.APSupplierID = dbo.APPOs.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPOs.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPOExpireDate IS NOT NULL AND {4} AND APPOHaveToPayPct>0 AND APPOFRAmtTot>0
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
            ---Lấy dữ liệu cho BeforeOverDue4 ở table Voucher
		    -------------------Voucher-----------------
		    SELECT SUM(GLVoucherRFAmtTot) AS BeforeOverDue4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.GLVouchers ON dbo.APSuppliers.APSupplierID = dbo.GLVouchers.FK_APSupplierID
		    INNER JOIN dbo.GLVoucherItems ON dbo.GLVouchers.GLVoucherID = dbo.GLVoucherItems.FK_GLVoucherID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND GLVouchers.AAStatus='Alive'
		    AND GLVoucherItems.AAStatus='Alive'
            AND GLVouchers.GLVoucherRAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND GLVoucherItems.GLVoucherItemDueDate IS NOT NULL AND {5} AND {2}
		    GROUP BY APSuppliers.APSupplierID

        ) AS BeforeOverDue4
        GROUP BY FK_APSupplierID", iSupplier, dtAgingOffDate.ToString("yyyyMMdd"), strAccount
, strBeforeOverDue4PInvoice, strBeforeOverDue4PO, strBeforeOverDue4Voucher);
            #endregion

            #region ---Câu Query 11 : Lấy dữ liệu cho BeforeOverDue4 bằng cách UNION 3 cấu query con ở 3 table PInvoice,PO,Voucher.
            String strQuery11 = String.Format(@"
       -----------------------AfterBefore4-------------------------------------------------
        SELECT 0 AS AmtTot,
        0 AS RemainAmtTot,
        0 AS RcpAmtTot,
        0 AS Before1,
        0 AS Before2,
        0 AS Before3,
        0 AS Before4,
        0 AS OverDue1,
        0 AS OverDue2,
        0 AS OverDue3,
        0 AS OverDue4,
        0 AS BeforeOverDue4,
        SUM(AfterBefore4) AS AfterBefore4,
        0 AS PmtReqAmtTot,
        FK_APSupplierID AS FK_APSupplierID,
        GETDATE() AS AgingOffDate
        FROM 
        (
            ---Lấy dữ liệu cho AfterBefore4 ở table PInvoice
		    -------------------PInvoice-----------------
		    SELECT SUM(APPInvoiceRFAmtTot) AS AfterBefore4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPInvoices ON dbo.APSuppliers.APSupplierID = dbo.APPInvoices.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPInvoices.AAStatus='Alive'
            AND APPInvoiceRFAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPInvoiceExpireDate IS NOT NULL AND {3}
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL

		    ---Lấy dữ liệu cho AfterBefore4 ở table PO
		    -------------------PO-----------------
		    SELECT SUM(APPOFRAmtTot) AS AfterBefore4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.APPOs ON dbo.APSuppliers.APSupplierID = dbo.APPOs.FK_APSupplierID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND APPOs.AAStatus='Alive'
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND APPOExpireDate IS NOT NULL AND {4} AND APPOHaveToPayPct>0 AND APPOFRAmtTot>0
		    GROUP BY APSuppliers.APSupplierID
		
		    UNION ALL
            ---Lấy dữ liệu cho AfterBefore4 ở table Voucher
		    -------------------Voucher-----------------
		    SELECT SUM(GLVoucherRFAmtTot) AS AfterBefore4,
				    APSuppliers.APSupplierID AS FK_APSupplierID
		    FROM APSuppliers 
		    INNER JOIN dbo.GLVouchers ON dbo.APSuppliers.APSupplierID = dbo.GLVouchers.FK_APSupplierID
		    INNER JOIN dbo.GLVoucherItems ON dbo.GLVouchers.GLVoucherID = dbo.GLVoucherItems.FK_GLVoucherID
		    WHERE APSuppliers.AAStatus='Alive'
		    AND GLVouchers.AAStatus='Alive'
		    AND GLVoucherItems.AAStatus='Alive'
            AND GLVouchers.GLVoucherRAmtTot>0
		    AND (APSuppliers.APSupplierID={0} OR 0={0})
		    AND GLVoucherItems.GLVoucherItemDueDate IS NOT NULL AND {5} AND {2}
		    GROUP BY APSuppliers.APSupplierID

        ) AS AfterBefore4
        GROUP BY FK_APSupplierID", iSupplier, dtAgingOffDate.ToString("yyyyMMdd"), strAccount
, strAfterBefore4PInvoice, strAfterBefore4PO, strAfterBefore4Voucher);
            #endregion

            #region ---Lấy dữ liệu từ các truy vấn con (11 câu query) , mỗi truy vấn con lấy dữ liệu cho 1 field, sau đó UNION lại
            String strQuery = String.Format(@"
    SELECT 
    SUM(AmtTot) AS AmtTot,
    SUM(RemainAmtTot) AS RemainAmtTot,
    SUM(RcpAmtTot) AS RcpAmtTot,
    SUM(Before1) AS Before1,
    SUM(Before2) AS Before2,
    SUM(Before3) AS Before3,
    SUM(Before4) AS Before4,
    SUM(OverDue1) AS OverDue1,
    SUM(OverDue2) AS OverDue2,
    SUM(OverDue3) AS OverDue3,
    SUM(OverDue4) AS OverDue4,
    SUM(BeforeOverDue4) AS BeforeOverDue4,
    SUM(AfterBefore4) AS AfterBefore4,
    SUM(PmtReqAmtTot) AS PmtReqAmtTot,
    FK_APSupplierID AS FK_APSupplierID,
    AgingOffDate AS AgingOffDate

    FROM 

    (
        {0}--Query 1

        UNION ALL

        {1}--Query 2       

        UNION ALL
        
        {2}--Query 3

        UNION ALL

        {3}--Query 4

        UNION ALL

        {4}--Query 5

        UNION ALL

        {5}--Query 6

        UNION ALL

        {6}--Query 7

        UNION ALL

        {7}--Query 8

        UNION ALL

        {8}--Query 9

        UNION ALL

        {9}--Query 10

        UNION ALL

        {10}--Query 11
    
    ) AS ABC

    GROUP BY FK_APSupplierID,AgingOffDate


", strQuery1,strQuery2,strQuery3,strQuery4,strQuery5,strQuery6,strQuery7,strQuery8,strQuery9,strQuery10,strQuery11);

            #endregion

            return GetDataSet(strQuery);
        }
    }
	#endregion
}