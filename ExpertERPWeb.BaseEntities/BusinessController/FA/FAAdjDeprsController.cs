using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region FAAdjDeprs
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:FAAdjDeprsController
	//Created Date:30 June 2015
	//-----------------------------------------------------------
	
	public class FAAdjDeprsController:BaseBusinessController
	{
		public FAAdjDeprsController()
		{
			dal= new DALBaseProvider("FAAdjDeprs",typeof(FAAdjDeprsInfo));
		}

        public DataSet GetDataByAssetAndAdjDeprDate(int iFAAssetID, DateTime dtFAAdjDeprDate)
        {
            string strQuery = string.Format(@"SELECT  dbo.FAAdjDeprs.*
                                        FROM    dbo.FAAdjDeprs
                                                INNER JOIN dbo.FAAdjDeprItems ON dbo.FAAdjDeprs.FAAdjDeprID = dbo.FAAdjDeprItems.FK_FAAdjDeprID
                                         AND dbo.FAAdjDeprs.AAStatus = 'Alive'
                                         AND dbo.FAAdjDeprItems.AAStatus = 'Alive'
                                         AND FK_FAAssetID = {0}
                                         AND ( CONVERT(NVARCHAR(10), FAAdjDeprDate, 112) = CONVERT(NVARCHAR(10), '{1}', 112) )", iFAAssetID, dtFAAdjDeprDate.ToString("yyyyMMdd"));
            return GetDataSet(strQuery);
        }
        // Lay Danh sach phieu thay doi phuong phap khau hao cho Tai San và Sau ngày tạo phiếu khấu hao.
        public DataSet GetDataByAssetAndAfterAdjDeprDate(int iFAAssetID, DateTime dtFAAdjDeprDate)
        {
            string strQuery = string.Format(@"SELECT  dbo.FAAdjDeprs.*
                                        FROM    dbo.FAAdjDeprs
                                                INNER JOIN dbo.FAAdjDeprItems ON dbo.FAAdjDeprs.FAAdjDeprID = dbo.FAAdjDeprItems.FK_FAAdjDeprID
                                         AND dbo.FAAdjDeprs.AAStatus = 'Alive'
                                         AND dbo.FAAdjDeprItems.AAStatus = 'Alive'
                                         AND FK_FAAssetID = {0}
                                         AND ( CONVERT(NVARCHAR(10), FAAdjDeprDate, 112) > CONVERT(NVARCHAR(10), '{1}', 112) )", iFAAssetID, dtFAAdjDeprDate.ToString("yyyyMMdd"));
            return GetDataSet(strQuery);
        }
	}
	#endregion
}