using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region FAAdjAssetAccs
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:FAAdjAssetAccsController
	//Created Date:Thursday, September 3, 2015
	//-----------------------------------------------------------
	
	public class FAAdjAssetAccsController:BaseBusinessController
	{
		public FAAdjAssetAccsController()
		{
			dal= new DALBaseProvider("FAAdjAssetAccs",typeof(FAAdjAssetAccsInfo));
		}

        //V.Hung add 07/09/2015 Lấy danh sách phiếu điều chỉnh theo TSCĐ và được tạo sau một ngày xác định
        public DataSet GetDataByAssetAfterDate(int iFAAssetID, DateTime dtDateTime)
        {
            string strQuery = string.Format(@"SELECT  dbo.FAAdjAssetAccs.*
                                                FROM    dbo.FAAdjAssetAccs
                                                        INNER JOIN dbo.FAAdjAssetAccItems ON dbo.FAAdjAssetAccs.FAAdjAssetAccID = dbo.FAAdjAssetAccItems.FK_FAAdjAssetAccID
                                                         AND dbo.FAAdjAssetAccs.AAStatus = 'Alive'
                                                         AND dbo.FAAdjAssetAccItems.AAStatus = 'Alive'
                                                         AND dbo.FAAdjAssetAccItems.FK_FAAssetID = {0}
                                                         AND CONVERT(NVARCHAR(10), dbo.FAAdjAssetAccs.FAAdjAssetAccDate, 112) > CONVERT(NVARCHAR(10), '{1}', 112)", iFAAssetID, dtDateTime.ToString("yyyyMMdd"));
            return GetDataSet(strQuery);
        }

        //V.Hung add 07/09/2015 Lấy danh sách phiếu điều chỉnh theo TSCĐ và Ngày tạo theo một ngày xác định
        public DataSet GetDataByAssetInDate(int iFAAssetID, DateTime dtDateTime)
        {
            string strQuery = string.Format(@"SELECT  dbo.FAAdjAssetAccs.*
                                                FROM    dbo.FAAdjAssetAccs
                                                        INNER JOIN dbo.FAAdjAssetAccItems ON dbo.FAAdjAssetAccs.FAAdjAssetAccID = dbo.FAAdjAssetAccItems.FK_FAAdjAssetAccID
                                                         AND dbo.FAAdjAssetAccs.AAStatus = 'Alive'
                                                         AND dbo.FAAdjAssetAccItems.AAStatus = 'Alive'
                                                         AND dbo.FAAdjAssetAccItems.FK_FAAssetID = {0}
                                                         AND CONVERT(NVARCHAR(10), dbo.FAAdjAssetAccs.FAAdjAssetAccDate, 112) = CONVERT(NVARCHAR(10), '{1}', 112)", iFAAssetID, dtDateTime.ToString("yyyyMMdd"));
            return GetDataSet(strQuery);
        }

        //V.Hung add 07/09/2015 Lấy danh sách phiếu điều chỉnh được tạo sau một ngày xác định
        public DataSet GetDataAfterDate(DateTime dtDateTime)
        {
            string strQuery = string.Format(@"SELECT  dbo.FAAdjAssetAccs.*
                                                FROM    dbo.FAAdjAssetAccs
                                                        INNER JOIN dbo.FAAdjAssetAccItems ON dbo.FAAdjAssetAccs.FAAdjAssetAccID = dbo.FAAdjAssetAccItems.FK_FAAdjAssetAccID
                                                         AND dbo.FAAdjAssetAccs.AAStatus = 'Alive'
                                                         AND dbo.FAAdjAssetAccItems.AAStatus = 'Alive'
                                                         AND CONVERT(NVARCHAR(10), dbo.FAAdjAssetAccs.FAAdjAssetAccDate, 112) > CONVERT(NVARCHAR(10), '{0}', 112)",dtDateTime.ToString("yyyyMMdd"));
            return GetDataSet(strQuery);
        }

	}
	#endregion
}