using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region GLAdjCostDists
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:GLAdjCostDistsController
	//Created Date:07 July 2015
	//-----------------------------------------------------------
	
	public class GLAdjCostDistsController:BaseBusinessController
	{
		public GLAdjCostDistsController()
		{
			dal= new DALBaseProvider("GLAdjCostDists",typeof(GLAdjCostDistsInfo));
		}
        // V.Hung 13/07/2015 Lấy tất cả phiếu thay đổi có chi tiết là CCDC truyền vào và phiếu được tạo sau ngày dtDateTime
        public DataSet GetAllDataByProductAfterDate(int iICProductID, DateTime dtDateTime)
        {
            string strQuery = string.Format(@"SELECT  dbo.GLAdjCostDists.*
                                                FROM    dbo.GLAdjCostDists
                                                        INNER JOIN dbo.GLAdjCostDistItems ON dbo.GLAdjCostDists.GLAdjCostDistID = dbo.GLAdjCostDistItems.FK_GLAdjCostDistID
                                                    AND dbo.GLAdjCostDists.AAStatus = 'Alive'
                                                    AND dbo.GLAdjCostDistItems.AAStatus = 'Alive'
                                                    AND dbo.GLAdjCostDistItems.FK_ICProductID = {0}
                                                    AND CONVERT(NVARCHAR(10), dbo.GLAdjCostDists.GLAdjCostDistDate, 112) > CONVERT(NVARCHAR(10), '{1}', 112)", iICProductID, dtDateTime.ToString("yyyyMMdd"));
            return GetDataSet(strQuery);
        }

        // V.Hung 13/07/2015 Lấy tất cả phiếu thay đổi có chi tiết CCDC truyền vào và phiếu được tạo trong ngày dtDateTime
        public DataSet GetAllDataByProductInDate(int iICProductID, DateTime dtDateTime)
        {
            string strQuery = string.Format(@"SELECT  dbo.GLAdjCostDists.*
                                                FROM    dbo.GLAdjCostDists
                                                        INNER JOIN dbo.GLAdjCostDistItems ON dbo.GLAdjCostDists.GLAdjCostDistID = dbo.GLAdjCostDistItems.FK_GLAdjCostDistID
                                                    AND dbo.GLAdjCostDists.AAStatus = 'Alive'
                                                    AND dbo.GLAdjCostDistItems.AAStatus = 'Alive'
                                                    AND dbo.GLAdjCostDistItems.FK_ICProductID = {0}
                                                    AND CONVERT(NVARCHAR(10), dbo.GLAdjCostDists.GLAdjCostDistDate, 112) = CONVERT(NVARCHAR(10), '{1}', 112)", iICProductID, dtDateTime.ToString("yyyyMMdd"));
            return GetDataSet(strQuery);
        }
	}
	#endregion
}