using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region GLEquipmentDecreases
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:GLEquipmentDecreasesController
	//Created Date:Thursday, December 15, 2011
	//-----------------------------------------------------------
	
	public class GLEquipmentDecreasesController:BaseBusinessController
	{
		public GLEquipmentDecreasesController()
		{
			dal= new DALBaseProvider("GLEquipmentDecreases",typeof(GLEquipmentDecreasesInfo));
		}

        public DataSet GetDataByProductAfterDate(int iICProduct, DateTime dtDateTime)
        {
            string strQuery = string.Format(@"SELECT  dbo.GLEquipmentDecreases.*
                                                FROM    dbo.GLEquipmentDecreaseItems
                                                        INNER JOIN dbo.GLEquipmentDecreases ON dbo.GLEquipmentDecreaseItems.FK_GLEquipmentDecreaseID = dbo.GLEquipmentDecreases.GLEquipmentDecreaseID
                                                                                               AND dbo.GLEquipmentDecreaseItems.AAStatus = 'Alive'
                                                                                               AND dbo.GLEquipmentDecreases.AAStatus = 'Alive'
                                                                                               AND FK_ICProductID = {0}
                                                                                               AND CONVERT(NVARCHAR(10), dbo.GLEquipmentDecreases.GLEquipmentDecreaseDate, 112) > CONVERT(NVARCHAR(10), '{1}', 112)", iICProduct, dtDateTime.ToString("yyyyMMdd"));
            return GetDataSet(strQuery);
        }

        //(Thang add 27/8/2015 Trong cùng 1 ngày CCDC đã có phiếu thanh lý thì không được phân bổ lại CCDC
        public DataSet GetDataByProductIsDate(int iCProduct, DateTime datetime)
        {
            string strQuery = string.Format(@"SELECT  dbo.GLEquipmentDecreases.*
                                                FROM    dbo.GLEquipmentDecreaseItems
                                                        INNER JOIN dbo.GLEquipmentDecreases ON dbo.GLEquipmentDecreaseItems.FK_GLEquipmentDecreaseID = dbo.GLEquipmentDecreases.GLEquipmentDecreaseID
                                                                                               AND dbo.GLEquipmentDecreaseItems.AAStatus = 'Alive'
                                                                                               AND dbo.GLEquipmentDecreases.AAStatus = 'Alive'
                                                                                               AND FK_ICProductID = {0}
                                                                                               AND CONVERT(NVARCHAR(10), dbo.GLEquipmentDecreases.GLEquipmentDecreaseDate, 112) = CONVERT(NVARCHAR(10), {1}, 112)
                                                                                               AND dbo.GLEquipmentDecreaseItems.GLEquipmentDecreaseItemTypeCombo = '{2}'", iCProduct, datetime.ToString("yyyyMMdd"), "ThanhLy");
            return dal.GetDataSet(strQuery);
        }
        //)
    }
	#endregion
}