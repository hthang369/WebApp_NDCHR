using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region GLTranCfgGroupRpts
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:GLTranCfgGroupRptsController
	//Created Date:Monday, August 25, 2014
	//-----------------------------------------------------------
	
	public class GLTranCfgGroupRptsController:BaseBusinessController
	{
		public GLTranCfgGroupRptsController()
		{
			dal= new DALBaseProvider("GLTranCfgGroupRpts",typeof(GLTranCfgGroupRptsInfo));
		}
        public DataSet GetDataByTranCfgGroupID(int piTranCfgGroupID, string psNotINID = "")
        {
            String strQuery = String.Format(@"SELECT * FROM dbo.GLTranCfgGroupRpts 
                            WHERE FK_GLTranCfgGroupID = {0}", piTranCfgGroupID);
            if (psNotINID != "")
                strQuery += String.Format(@"
                            AND GLTranCfgGroupRptID NOT IN ({0})", psNotINID);
            return dal.GetDataSet(strQuery);
        }
        public DataSet GetDataByModuleName(string psModName, string psNotINID = "")
        {
            String strQuery = String.Format(@"SELECT a.* FROM dbo.GLTranCfgGroupRpts a
INNER JOIN GLTranCfgGroups b ON a.FK_GLTranCfgGroupID = b.GLTranCfgGroupID
INNER JOIN GLTranCfgGroupModules c ON c.FK_GLTranCfgGroupID = b.GLTranCfgGroupID 
    AND GLTranCfgGroupModuleName = '{0}'", psModName);
            if (psNotINID != "")
                strQuery += String.Format(@"
                            AND GLTranCfgGroupRptID NOT IN ({0})", psNotINID);
            return dal.GetDataSet(strQuery);
        }
    }
	#endregion
}