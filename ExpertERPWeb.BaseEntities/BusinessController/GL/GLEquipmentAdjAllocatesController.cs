using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region GLEquipmentAdjAllocates
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:GLEquipmentAdjAllocatesController
	//Created Date:14 July 2015
	//-----------------------------------------------------------
	
	public class GLEquipmentAdjAllocatesController:BaseBusinessController
	{
		public GLEquipmentAdjAllocatesController()
		{
			dal= new DALBaseProvider("GLEquipmentAdjAllocates",typeof(GLEquipmentAdjAllocatesInfo));
		}

        public DataSet GetAllDataAfterDate(DateTime dtDateTime)
        {
            string strQuery = string.Format(@"SELECT  *
                        FROM    dbo.GLEquipmentAdjAllocates
                        WHERE   AAStatus = 'Alive'
                                AND CONVERT(NVARCHAR(10), GLEquipmentAdjAllocateDate, 112) > CONVERT(NVARCHAR(10), '{0}', 112)
                        ORDER BY GLEquipmentAdjAllocateDate DESC ,
                                GLEquipmentAdjAllocateID DESC",dtDateTime.ToString("yyyyMMdd"));
            return GetDataSet(strQuery);
        }

        public DataSet GetAllDataInDate(int iICProductID,DateTime dtDateTime)
        {
            string strQuery = string.Format(@"SELECT  dbo.GLEquipmentAdjAllocates.*
                            FROM    dbo.GLEquipmentAdjAllocates
                                    INNER JOIN dbo.GLEquipmentAdjAllocateItems ON dbo.GLEquipmentAdjAllocates.GLEquipmentAdjAllocateID = dbo.GLEquipmentAdjAllocateItems.FK_GLEquipmentAdjAllocateID
                                                                                  AND dbo.GLEquipmentAdjAllocates.AAStatus = 'Alive'
                                                                                  AND dbo.GLEquipmentAdjAllocateItems.AAStatus = 'Alive'
                                                                                  AND FK_ICProductID = {0}
                                                                                  AND CONVERT(NVARCHAR(10), GLEquipmentAdjAllocateDate, 112) = CONVERT(NVARCHAR(10), '{1}', 112)
                            ORDER BY GLEquipmentAdjAllocateDate DESC ,
                                    GLEquipmentAdjAllocateID DESC",iICProductID, dtDateTime.ToString("yyyyMMdd"));
            return GetDataSet(strQuery);
        }

        // V.Hung add 18/08/2015

        public DataSet GetDataByPeriodEquipmentAllocateItem(int iGLPeriodEquipmentAllocateItemID)
        { 
            string strQuery=String.Format(@"SELECT  dbo.GLEquipmentAdjAllocates.*
        FROM    dbo.GLEquipmentAdjAllocateItems
                INNER JOIN dbo.GLEquipmentAdjAllocates ON dbo.GLEquipmentAdjAllocateItems.FK_GLEquipmentAdjAllocateID = dbo.GLEquipmentAdjAllocates.GLEquipmentAdjAllocateID
                                                          AND dbo.GLEquipmentAdjAllocateItems.AAStatus = 'Alive'
                                                          AND dbo.GLEquipmentAdjAllocates.AAStatus = 'Alive'
                                                          AND FK_GLPeriodEquipmentAllocateItemID = {0}",iGLPeriodEquipmentAllocateItemID);
            return GetDataSet(strQuery);
        }

	}
	#endregion
}