using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region GLSyncCfgs
	//-----------------------------------------------------------
	//Generated By: SQLDBTools.NET ♫ Hồռ؏ ₤ĩռᶋ (v2.0.68)
	//Class: GLSyncCfgsController
	//Created Date: Tuesday, 09 Jan 2018
	//-----------------------------------------------------------
	
	public class GLSyncCfgsController : BaseBusinessController
	{
		public GLSyncCfgsController()
		{
			dal = new DALBaseProvider("GLSyncCfgs",typeof(GLSyncCfgsInfo));
		}
        public void SetRunByUserID(string sUserName, bool isRun)
        {
            GMCDbUtil.ExecuteQuery(string.Format(@"
                    UPDATE a 
                    SET GLSyncCfgIsRun = '{0}'
                    FROM GLSyncCfgs a
                    JOIN ADUsers b ON a.FK_ADUserID = b.ADUserID
                        AND b.AAStatus = 'Alive' AND a.AAStatus = 'Alive'
                    WHERE ADUserName = '{1}'", isRun, sUserName));
        }
        public void SetUserSyncDB(string sUserName)
        {
            GMCDbUtil.ExecuteQuery(string.Format(@"
                    UPDATE GLSyncCfgs
                    SET FK_ADUserID = (SELECT TOP 1 ADUserID FROM ADUsers WHERE AAStatus = 'Alive' AND ADUserName = '{0}')
                    WHERE GLSyncCfgID = 1", sUserName));
        }
	}
	#endregion
}