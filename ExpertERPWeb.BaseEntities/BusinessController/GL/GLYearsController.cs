using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region GLYears
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:GLYearsController
	//Created Date:Thursday, March 01, 2012
	//-----------------------------------------------------------
	
	public class GLYearsController:BaseBusinessController
	{
		public GLYearsController()
		{
			dal= new DALBaseProvider("GLYears",typeof(GLYearsInfo));
		}

        public DataSet GetAllObjectSortByStartDate()
        {
            String strQuery = String.Format("SELECT * FROM GLYears WHERE AASTatus = 'Alive' ORDER BY GLYearStartDate");

            return GetDataSet(strQuery);
        }

        public GLYearsInfo GetObjectByYear(int iYear)
        {
            String strQuery = String.Format("SELECT * FROM GLYears WHERE AASTatus = 'Alive' AND GLYear = {0}", iYear);

            DataSet ds =  GetDataSet(strQuery);

            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                return (GLYearsInfo)GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            }

            return null;
        }

        public Boolean KiemTraCoKhoaSoNamTaiChinh(int iYear)
        {
            String strQuery = String.Format("SELECT * FROM GLYears WHERE GLYear = {0} AND GLYearStatus LIKE 'Lock'", iYear);
            DataSet ds = dal.GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                return true;
            }
            return false;
        }

        public void KhoaSoNamTaiChinh(int iYear)
        {
            String strQuery = String.Format(@"  UPDATE GLYears 
                                                SET GLYearStatus = 'Lock'
                                                WHERE GLYear = {0}", iYear);
            DataSet ds = dal.GetDataSet(strQuery);
        }
	}
	#endregion
}