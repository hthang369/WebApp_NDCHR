using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ICAssemblys
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ICAssemblysController
	//Created Date:Monday, November 07, 2011
	//-----------------------------------------------------------
	
	public class ICAssemblysController:BaseBusinessController
	{
		public ICAssemblysController()
		{
			dal= new DALBaseProvider("ICAssemblys",typeof(ICAssemblysInfo));
		}
        public ICAssemblysInfo GetFirstDeAssemblyByProductNoOutInRange(string strProductNo,DateTime dteFromDate,DateTime dteToDate)
        {
            string strQuery = string.Format(@"select * from ICAssemblys where AAStatus='Alive' and ICAssemblyTypeCombo='DeAssembly' AND 
                                                    ICAssemblyID in (Select FK_ICAssemblyID from ICAssemblyItemOuts where AAStatus='Alive' and FK_ICProductID in (
                                                        Select ICProductID from ICProducts where AAStatus='Alive' and ICProductNo='{0}')) AND
                                                    ", strProductNo);
            string strDate = DALUtil.GenerateBeetween("ICAssemblyDate", dteFromDate, dteToDate);
            strQuery += strDate;
            DataSet ds = dal.GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
                return (ICAssemblysInfo)dal.GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            return null;
        }
	}
	#endregion
}