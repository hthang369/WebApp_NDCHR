using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ICQCItems
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ICQCItemsController
	//Created Date:18 Tháng Chín 2013
	//-----------------------------------------------------------
	
	public class ICQCItemsController:BaseBusinessController
	{
		public ICQCItemsController()
		{
			dal= new DALBaseProvider("ICQCItems",typeof(ICQCItemsInfo));
		}
        public double GetTotalQtyByAPSemiOrdrPlanID(int iAPSemiOrdrPlanID)
        {
            string strQuery = string.Format(@"select SUM(ICQCItemQty) from ICQCItems where AAStatus='Alive'
                                                       AND ICQCItemID in (Select FK_ICQCItemID from ICQCItemReceiptItems where AAStatus='Alive'
                                        AND FK_ICReceiptItemID in 
	                                        (
		                                        select FK_ICReceiptItemID from ICReceiptItemPurchaseOrderItems where AAStatus='Alive'
		                                        AND FK_APPOItemID in 
			                                        (
				                                        Select APPOItemID from APPOItems where AAStatus='Alive' AND
                                                            APPOItemID in (select FK_APPOItemID from APPOItemSemiOrdPlans where FK_APSemiOrdPlanID ={0})
			                                        )
	                                        )
                                          )", iAPSemiOrdrPlanID);
            DataSet ds = dal.GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0 && ds.Tables[0].Rows[0][0] != DBNull.Value)
                return Convert.ToDouble(ds.Tables[0].Rows[0][0]);
            return 0;
        }

    }
	#endregion
}