using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ICLots
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ICLotsController
	//Created Date:Friday, October 31, 2014
	//-----------------------------------------------------------
	
	public class ICLotsController:BaseBusinessController
	{
		public ICLotsController()
		{
			dal= new DALBaseProvider("ICLots",typeof(ICLotsInfo));
		}

         public int GetLotIDByModuleNameAndICProductID( int iICProductID, String strSTModuleName )
         {
            int iLotID = 0;
            String strQuery = String.Format(@"  SELECT DISTINCT a.FK_ICLotID
                                                FROM ICProductLots a INNER JOIN ICLots b ON a.FK_ICLotID = b.ICLotID
                                                WHERE a.FK_ICLotID = b.ICLotID
                                                      AND b.AAStatus = 'Alive'
                                                      AND a.FK_ICProductID = {0}
                                                      AND a.STModuleName = '{1}' ", iICProductID, strSTModuleName);

            DataSet ds = dal. GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                iLotID =int.Parse( ds.Tables[0].Rows[0][0].ToString());
            }

            return iLotID;
        }

         public DataSet GetAAColumnAliasNameByTableName(String strTableName)
         {
             String strquery = string.Format(@"SELECT    AATableName ,
                                                        AAColumnAliasName AS GLTranCfgGroupDefaultValueField ,
                                                        AAColumnAliasCaption
                                                FROM    dbo.AAColumnAlias a
                                                        INNER JOIN ( SELECT MAX(AAColumnAliasID) AS AAColumnAliasID
                                                                     FROM   dbo.AAColumnAlias
                                                                     WHERE  AATableName = '{0}'
                                                                     GROUP BY AAColumnAliasName ,
                                                                            AATableName
                                                                   ) b ON a.AAColumnAliasID = b.AAColumnAliasID", strTableName);
             return GetDataSet(strquery);
         }

	}
	#endregion
}