using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ICProductAttrs
	//-----------------------------------------------------------
	//Generated By: Expert Studio
	//Class:ICProductAttrsController
	//Created Date:Tuesday, April 24, 2012
	//-----------------------------------------------------------
	
	public class ICProductAttrsController:BaseBusinessController
	{
		public ICProductAttrsController()
		{
			dal= new DALBaseProvider("ICProductAttrs",typeof(ICProductAttrsInfo));
		}

        public ICProductAttrsInfo GetProductAttrByName(String ProductAttrName,int ProductID)
        {
            String StrQuery=String.Format(@"Select * from ICProductAttrs Where AAStatus='Alive' and ICProductAttrName='{0}' and FK_ICProductID={1}",ProductAttrName,ProductID);
            DataSet ds = dal.GetDataSet(StrQuery);
            if (ds == null || ds.Tables.Count <= 0 || ds.Tables[0].Rows.Count <= 0)
                return null;
            return (ICProductAttrsInfo)dal.GetObjectFromDataRow(ds.Tables[0].Rows[0]);
        }
        public DataSet GetProductAttrByGroupAndName(String ProductAttrName, int iProductGroupID)
        {
            String StrQuery = String.Format(@"Select DISTINCT ICProductAttrValue from ICProductAttrs Where AAStatus='Alive' and ICProductAttrName='{0}' 
                                            and FK_ICProductID in (Select ICProductID from ICProducts where AAStatus='Alive' and FK_ICProductGroupID={1})"
                                        , ProductAttrName, iProductGroupID);
            return dal.GetDataSet(StrQuery);
        }   
	}
	#endregion
}