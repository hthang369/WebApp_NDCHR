using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ICProductLots
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ICProductLotsController
	//Created Date:Monday, November 03, 2014
	//-----------------------------------------------------------
	
	public class ICProductLotsController:BaseBusinessController
	{
		public ICProductLotsController()
		{
			dal= new DALBaseProvider("ICProductLots",typeof(ICProductLotsInfo));
		}

        public int GetLotIDByModuleNameAndICProductID( int iICProductID, String strSTModuleName )
        {
            int iLotID = 0;
            DataSet ds = new DataSet();
            String strQuery = String.Format(@"  SELECT DISTINCT a.FK_ICLotID
                                                FROM ICProductLots a INNER JOIN ICLots b ON a.FK_ICLotID = b.ICLotID
                                                WHERE a.FK_ICLotID = b.ICLotID
                                                      AND b.AAStatus = 'Alive'
                                                      AND a.FK_ICProductID = {0}
                                                      AND a.STModuleName = '{1}' ", iICProductID, strSTModuleName);

            ds = GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                iLotID = int.Parse(ds.Tables[0].Rows[0][0].ToString());
            }

            return iLotID;
        }

	}
	#endregion
}