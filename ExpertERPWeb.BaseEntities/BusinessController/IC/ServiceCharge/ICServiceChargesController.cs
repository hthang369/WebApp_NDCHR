using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ICServiceCharges
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ICServiceChargesController
	//Created Date:20 Tháng Chín 2012
	//-----------------------------------------------------------
	
	public class ICServiceChargesController:BaseBusinessController
	{
		public ICServiceChargesController()
		{
			dal= new DALBaseProvider("ICServiceCharges",typeof(ICServiceChargesInfo));
		}

        #region Check IsExist DocNo --Vinh --19/09/2012

        public Boolean CheckIsExistServiceChargeDocNo(String strDocNo)
        {
            String str = String.Format(@"SELECT * FROM ICServiceCharges WHERE AAStatus='Alive' AND ICServiceChargeDocNo='{0}'", strDocNo);
            DataSet ds = dal.GetDataSet(str);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                return true;
            }
            return false;
        }

        #endregion

        public ICServiceChargesInfo CheckObjectByInvChargeByYearMonth(int iPeriod, int iYear, int iCustomerID,string strType)
        {
            string strQuery = string.Format(@"Select * from ICServiceCharges where AAStatus='Alive' and ICServiceChargePeriod={0} and ICServiceChargeYear={1} and FK_ARCustomerID={2} And ICServiceChargeTypeCombo='{3}'", iPeriod, iYear, iCustomerID,strType);
            DataSet ds = dal.GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
                return (ICServiceChargesInfo)dal.GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            return null;
        }
	}
	#endregion
}