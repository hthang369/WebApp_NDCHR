using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region HREmployeeShuffleItems
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:HREmployeeShuffleItemsController
	//Created Date:Wednesday, September 20, 2017
	//-----------------------------------------------------------
	
	public class HREmployeeShuffleItemsController:BaseBusinessController
	{
		public HREmployeeShuffleItemsController()
		{
			dal= new DALBaseProvider("HREmployeeShuffleItems",typeof(HREmployeeShuffleItemsInfo));
		}
        public DataSet GetAllDataByEmployeeID(int iEmployeeID)
        {
            string str = string.Format(@"SELECT * 
                                        FROM dbo.HREmployeeShuffleItems
                                         JOIN dbo.HREmployeeShuffles
                                         ON(HREmployeeShuffles.HREmployeeShuffleID = HREmployeeShuffleItems.FK_HREmployeeShuffleID 
                                            AND HREmployeeShuffles.AAStatus = HREmployeeShuffleItems.AAStatus)
                                         WHERE HREmployeeShuffleItems.AAStatus = 'Alive' AND HREmployeeShuffleItems.FK_HREmployeeID ={0}",iEmployeeID);
            return dal.GetDataSet(str);
        }
        public HREmployeeShuffleItemsInfo GetShuffleItemByEmployeeIDAndFDateTDate(int iEmployeeID, DateTime FDate, DateTime TDate)
        {
            string str = string.Format(@"SELECT HREmployeeShuffleItems.*
                                        FROM dbo.HREmployeeShuffleItems
                                        JOIN dbo.HREmployeeShuffles 
                                        ON (HREmployeeShuffles.HREmployeeShuffleID = HREmployeeShuffleItems.FK_HREmployeeShuffleID AND HREmployeeShuffles.AAStatus = HREmployeeShuffleItems.AAStatus)
                                        WHERE HREmployeeShuffleItems.AAStatus='Alive'
                                        AND HREmployeeShuffleItems.FK_HREmployeeID={0}
                                        AND CONVERT(NVARCHAR(10), HREmployeeShuffles.HREmployeeShuffleValidityDate, 112) >= '{1}'
                                        AND CONVERT(NVARCHAR(10),  HREmployeeShuffles.HREmployeeShuffleValidityDate, 112) <= '{2}' ORDER BY HREmployeeShuffleItemID DESC", iEmployeeID,FDate.ToString("yyyyMMdd"), TDate.ToString("yyyyMMdd"));
            DataSet ds = dal.GetDataSet(str);
            if(ds!=null && ds.Tables.Count>0 && ds.Tables[0].Rows.Count>0)
            {
                return (HREmployeeShuffleItemsInfo)GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            }
            return null;
        }
    }
	#endregion
}