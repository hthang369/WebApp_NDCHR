using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region HRCandidates
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:HRCandidatesController
	//Created Date:28 Tháng Năm 2013
	//-----------------------------------------------------------
	
	public class HRCandidatesController:BaseBusinessController
	{
		public HRCandidatesController()
		{
			dal= new DALBaseProvider("HRCandidates",typeof(HRCandidatesInfo));
		}

        public DataSet LayTatCaUngVienTheoKeHoachViTriVaMaSo(int iRecruitPlnID, int iPositionID, String strCandidateNo)

        {
            String str = String.Format(@"   SELECT * FROM dbo.HRCandidates
                                            WHERE AAStatus='Alive'
                                            AND FK_HRPositionID IN (
							                                            SELECT FK_HRPositionID FROM dbo.HRRecruitPlnItems 
							                                            WHERE AAStatus = 'Alive'
							                                            AND (FK_HRPositionID = {1} OR {1} = 0)
							                                            AND FK_HRRecruitPlnID IN	(
															                                            SELECT HRRecruitPlnID FROM dbo.HRRecruitPlns
															                                            WHERE AAStatus = 'Alive'
															                                            AND (HRRecruitPlnID = {0}  OR {0} = 0)
														                                            )
						                                            )", iRecruitPlnID, iPositionID);
            if (!String.IsNullOrEmpty(strCandidateNo))
            {
                str += String.Format(@" AND HRCandidateNo LIKE '{0}'", strCandidateNo);
            }
            return dal.GetDataSet(str);
        }
        public DataSet GetAllCandidateNoneInterviewCal()
        {
            string strsql = @"SELECT * FROM dbo.HRCandidates
                                         WHERE AAStatus='Alive'
                                         AND HRCandidateID NOT IN (SELECT ISNULL(FK_HRCandidateID,0)
                                         FROM dbo.HRInterviewCals
                                         WHERE AAStatus = 'Alive')";
            return dal.GetDataSet(strsql);
        }
	}
	#endregion
}