using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region HRWorkSheets
	//-----------------------------------------------------------
	//Generated By: SQLDBTools.Net ♫ Hồռ؏ ₤ĩռᶋ (v2.0.71)
	//Class: HRWorkSheetsController
	//Created Date: Wednesday, 28 Feb 2018
	//-----------------------------------------------------------
	
	public class HRWorkSheetsController : BaseBusinessController
	{
		public HRWorkSheetsController()
		{
			dal = new DALBaseProvider("HRWorkSheets",typeof(HRWorkSheetsInfo));
		}
        public void DeleteAllWorkSheetByEmpployeeIDAndPeriodID(int iEmployeeID, int iPeriod)
        {
            String str = String.Format(@"DELETE HRWorkSheets
                                        WHERE FK_HREmployeeID ={0}
                                        AND FK_HRPeriodID={1}", iEmployeeID, iPeriod);
            dal.GetDataSet(str);
        }
        public DataSet SelectAllWorkSheetByEmployeeIDAndPeriodID(int iEmployeeID, int iPeriod)
        {
            String str = String.Format(@"SELECT *
                                        FROM HRWorkSheets
                                        WHERE FK_HREmployeeID ={0}
                                        AND FK_HRPeriodID={1}", iEmployeeID, iPeriod);
           return dal.GetDataSet(str);
        }
        public DataSet SelectAllWorkSheetByPeriodID(int iPeriod)
        {
            String str = String.Format(@"SELECT *
                                         FROM HRWorkSheets
                                        WHERE FK_HRPeriodID={0}",iPeriod);
          return dal.GetDataSet(str);
        }
        public int GetTotalAnnualDayPreMonth(int iEmployeeID, int iMonth, int iYear)
        {
            string sql = string.Format(@"SELECT ISNULL(SUM(ISNULL(HRWorkSheetAnnualDay,0)),0)
                                            FROM dbo.HRWorkSheets
                                            WHERE FK_HREmployeeID={0}
                                            AND HRWorkSheetAnnualOldMonth >=1 AND HRWorkSheetMonth <={1}
                                            AND HRWorkSheetYear={2}", iEmployeeID, iMonth, iYear);
            DataSet ds = dal.GetDataSet(sql);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                if (ds.Tables[0].Rows[0][0] != DBNull.Value)
                    return Convert.ToInt32(ds.Tables[0].Rows[0][0]);
                return 0;
            }
            return 0;
        }
    }
	#endregion
}