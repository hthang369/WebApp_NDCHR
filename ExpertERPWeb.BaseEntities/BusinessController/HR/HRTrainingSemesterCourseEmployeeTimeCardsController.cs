using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region HRTrainingSemesterCourseEmployeeTimeCards
	//-----------------------------------------------------------
	//Generated By: Expert Studio
	//Class:HRTrainingSemesterCourseEmployeeTimeCardsController
	//Created Date:29 Tháng Năm 2013
	//-----------------------------------------------------------
	
	public class HRTrainingSemesterCourseEmployeeTimeCardsController:BaseBusinessController
	{
		public HRTrainingSemesterCourseEmployeeTimeCardsController()
		{
			dal= new DALBaseProvider("HRTrainingSemesterCourseEmployeeTimeCards",typeof(HRTrainingSemesterCourseEmployeeTimeCardsInfo));
		}

        public DataSet LayDiemDanhDaoTaoTheoMonHocNhanVienVaThoiGian(int iTrainingSemesterCourseEmployeeID, DateTime dtFrom, DateTime dtTo)
        {
            String str = String.Format(@"   SELECT * FROM dbo.HRTrainingSemesterCourseEmployeeTimeCards
                                            WHERE AAStatus='Alive'
                                            AND (FK_HRTrainingSemesterCourseEmployeeID = {0} OR {0} = 0)
                                            AND CONVERT(NVARCHAR(10),HRTrainingSemesterCourseEmployeeTimeCardDate,112) >= '{1}'
                                            AND CONVERT(NVARCHAR(10),HRTrainingSemesterCourseEmployeeTimeCardDate,112) <= '{2}'", iTrainingSemesterCourseEmployeeID, dtFrom.ToString("yyyyMMdd"), dtTo.ToString("yyyyMMdd"));
            return dal.GetDataSet(str);
        }

        public double GetResultByTrainingSemesterAndCourseAndEmployeeAndObjectType(int iTrainingSemesterID, int iCourseID, int iEmployeeID, String strTypeValue)
        {
            String strQuery = String.Format(@"SELECT COUNT(*) FROM HRTrainingSemesterCourseEmployeeTimeCards WHERE AAStatus='Alive' AND FK_HRTrainingSemesterID={0} AND FK_HRCourseID={1} AND FK_HREmployeeID={2}  AND HRTrainingSemesterCourseEmployeeTimeCardTypeCombo='{3}' ", iTrainingSemesterID, iCourseID, iEmployeeID, strTypeValue);

            DataSet ds = GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0
                && ds.Tables[0].Rows[0][0] != null && ds.Tables[0].Rows[0][0] != DBNull.Value)
                return Convert.ToDouble(ds.Tables[0].Rows[0][0]);

            return 0;
        }


        public DataSet GetAllDataByTrainingSemesterAndCourse(int iTrainingSemesterID, int iCourseID)
        {
            String strQuery = String.Format(@"SELECT * FROM HRTrainingSemesterCourseEmployeeTimeCards WHERE AAStatus='Alive' AND (FK_HRTrainingSemesterID={0} OR 0={0}) AND (FK_HRCourseID={1} OR 0={1})", iTrainingSemesterID, iCourseID);
            return GetDataSet(strQuery);
        }
    }
	#endregion
}