using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region HRNormsSupportCfgs
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:HRNormsSupportCfgsController
	//Created Date:Tuesday, March 27, 2018
	//-----------------------------------------------------------
	
	public class HRNormsSupportCfgsController:BaseBusinessController
	{
		public HRNormsSupportCfgsController()
		{
			dal= new DALBaseProvider("HRNormsSupportCfgs",typeof(HRNormsSupportCfgsInfo));
		}
        public double GetNormsSupportCfgDayByPositionID(int iPositionID)
        {
            String str = String.Format(@"SELECT * 
                                        FROM HRNormsSupportCfgs
                                        WHERE FK_HRPositionID={0}",iPositionID);
            DataSet ds = dal.GetDataSet(str);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                if (ds.Tables[0].Rows[0]["HRNormsSupportCfgDay"] != DBNull.Value)
                    return Convert.ToDouble(ds.Tables[0].Rows[0]["HRNormsSupportCfgDay"]);
                return 0;
            }
            return 0;
        }
        public DataSet GetNormsSupportCfgByPositionIDAreaID(int iPositionID, int iAreaID)
        {
            String str = String.Format(@"SELECT TOP 1 HRNormsSupportCfgs.*
                                        FROM HRNormsSupportCfgs
                                        WHERE FK_HRPositionID={0}
                                        AND FK_HRAreaID={1}", iPositionID,iAreaID);
            return dal.GetDataSet(str);
        }
        public HRNormsSupportCfgsInfo GetNormsSupportCfgByPositionID(int iPositionID)
        {
            String str = String.Format(@"SELECT TOP 1 HRNormsSupportCfgs.*
                                        FROM HRNormsSupportCfgs
                                        WHERE FK_HRPositionID>0 AND FK_HRPositionID={0}
                                        AND ISNULL(FK_HRAreaID,0)=0", iPositionID);
            DataSet ds= dal.GetDataSet(str);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                return (HRNormsSupportCfgsInfo)dal.GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            }
            return null;
        }
        public HRNormsSupportCfgsInfo GetNormsSupportCfgByAreaID(int iAreaID)
        {
            String str = String.Format(@"SELECT TOP 1 HRNormsSupportCfgs.*
                                        FROM HRNormsSupportCfgs
                                        WHERE FK_HRPositionID=0
                                        AND ISNULL(FK_HRAreaID,0)>0 AND FK_HRAreaID={0}", iAreaID);
            DataSet ds = dal.GetDataSet(str);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                return (HRNormsSupportCfgsInfo)dal.GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            }
            return null;
        }
    }
	#endregion
}