using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
    #region HRPayrollTypes
    //-----------------------------------------------------------
    //Generated By: GMC Studio
    //Class:HRPayrollTypesController
    //Created Date:13 Tháng Năm 2013
    //-----------------------------------------------------------

    public class HRPayrollTypesController : BaseBusinessController
    {
        public HRPayrollTypesController()
        {
            dal = new DALBaseProvider("HRPayrollTypes", typeof(HRPayrollTypesInfo));
        }
        public DataSet GetAllDataByAttributeTypeCombo(string strAttributeType)
        {
            string strQuery = string.Format(@"SELECT * FROM HRPayrollTypes WHERE AAStatus='Alive' AND HRPayrollTypeAttributeCombo='{0}'", strAttributeType);
            return dal.GetDataSet(strQuery);
        }
        public DataSet GetAllDataAttributeType()
        {
            string strQuery = string.Format(@"SELECT DISTINCT HRPayrollTypeAttributeCombo 
                                            FROM HRPayrollTypes
                                            WHERE AAStatus='Alive' AND HRPayrollTypeAttributeCombo <>'' AND HRPayrollTypeAttributeCombo IS NOT NULL");
            return dal.GetDataSet(strQuery);
        }
        public DataSet GetAllPayRollTypeByBonusAllowanceDate(DateTime dtDate)
        {
            string strQuery = string.Format(@"SELECT *
                                            FROM dbo.HRPayrollTypes
                                            JOIN dbo.HRBonusAllowances 
                                            ON (HRBonusAllowances.FK_HRPayrollTypeID = HRPayrollTypes.HRPayrollTypeID AND HRBonusAllowances.AAStatus = HRPayrollTypes.AAStatus)
                                            WHERE HRBonusAllowanceMonth = {0}
                                            AND HRBonusAllowanceYear = {1}", dtDate.Month, dtDate.Year);
            return dal.GetDataSet(strQuery);
        }

    }
    #endregion
}