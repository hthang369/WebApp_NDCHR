using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region HRWorkSheetItems
	//-----------------------------------------------------------
	//Generated By: SQLDBTools.Net ♫ Hồռ؏ ₤ĩռᶋ (v2.0.71)
	//Class: HRWorkSheetItemsController
	//Created Date: Wednesday, 28 Feb 2018
	//-----------------------------------------------------------
	
	public class HRWorkSheetItemsController : BaseBusinessController
	{
		public HRWorkSheetItemsController()
		{
			dal = new DALBaseProvider("HRWorkSheetItems",typeof(HRWorkSheetItemsInfo));
		}
        public void DeleteAllWorkSheetItemByEmpployeeIDAndPeriodID(int iEmployeeID, int iPeriod)
        {
            String str = String.Format(@"DELETE HRWorkSheetItems
                                        WHERE FK_HREmployeeID ={0}
                                        AND FK_HRPeriodID={1}", iEmployeeID,iPeriod);
            dal.GetDataSet(str);
        }
        public DataSet GetAllWorkSheetItemFDateTDate(DateTime dteFromdate, DateTime dteTodate)
        {
            String str = String.Format(@"SELECT * FROM dbo.HRWorkSheetItems
                                            WHERE CONVERT(NVARCHAR(10), HRWorkSheetItemDate, 112) >= CONVERT(NVARCHAR(10), '{0}', 112)
                                            AND CONVERT(NVARCHAR(10), HRWorkSheetItemDate, 112) <= CONVERT(NVARCHAR(10), '{1}', 112)", dteFromdate.ToString("yyyyMMdd"), dteTodate.ToString("yyyyMMdd"));
            return dal.GetDataSet(str);
        }
        public DataSet GetAllWorkSheetItemByEmployeeFDateTDate(int iEmployeeID,DateTime dteFromdate, DateTime dteTodate)
        {
            String str = String.Format(@"SELECT * FROM dbo.HRWorkSheetItems
                                            WHERE FK_HREmployeeID ={0} AND CONVERT(NVARCHAR(10), HRWorkSheetItemDate, 112) >= CONVERT(NVARCHAR(10), '{1}', 112)
                                            AND CONVERT(NVARCHAR(10), HRWorkSheetItemDate, 112) <= CONVERT(NVARCHAR(10), '{2}', 112)", iEmployeeID,dteFromdate.ToString("yyyyMMdd"), dteTodate.ToString("yyyyMMdd"));
            return dal.GetDataSet(str);
        }
        public DataSet GetAllWorkSheetItemOverTimeByDate(DateTime dtFrom, DateTime dtTo)
        {
            String str = String.Format(@" SELECT FK_HREmployeeID,HROvertimeRateNo,ISNULL(SUM(ISNULL(HRWorkSheetItemHourAmt,0)),0) AS tangca
                                            FROM dbo.HRWorkSheetItems
                                            JOIN HROvertimeRates ON (HROvertimeRates.HROvertimeRateID = HRWorkSheetItems.FK_HROvertimeRateID)
                                            WHERE HROvertimeRates.AAStatus = 'Alive' 
                                             AND CONVERT(NVARCHAR(10), HRWorkSheetItems.HRWorkSheetItemDate, 112) >= '{0}'
                                             AND CONVERT(NVARCHAR(10), HRWorkSheetItems.HRWorkSheetItemDate, 112) <= '{1}'
                                            GROUP BY FK_HREmployeeID,HROvertimeRateNo
                                            HAVING ISNULL(SUM(ISNULL(HRWorkSheetItemHourAmt,0)),0)>0 AND ISNULL(SUM(ISNULL(hRWorkSheetItemHourCalAmt,0)),0)>0
                                            ORDER BY FK_HREmployeeID", dtFrom.ToString("yyyyMMdd"), dtTo.ToString("yyyyMMdd"));
            return dal.GetDataSet(str);
        }
    }
	#endregion
}