using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region HRShifts
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:HRShiftsController
	//Created Date:Wednesday, April 08, 2009
	//-----------------------------------------------------------
	
	public class HRShiftsController:BaseBusinessController
	{
		public HRShiftsController()
		{
			dal= new DALBaseProvider("HRShifts",typeof(HRShiftsInfo));
		}

        #region Get Shift Manual --Vinh --04/02/2013 --Lấy ca làm việc Hành chánh của Công Nhân (CN-) hay Văn Phòng (VP-)

        public HRShiftsInfo GetShiftManual(String strTypeName)
        {
            String str = String.Format(@"SELECT * FROM dbo.HRShifts WHERE AAStatus='Alive' AND HRShiftName LIKE '{0}%' AND HRShiftName LIKE '%HANHCHANH%'", strTypeName);
            DataSet ds = GetDataSet(str);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count>0)
            {
                return (HRShiftsInfo)dal.GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            }
            return null;
        }

        #endregion

        #region Get Shift --Vinh --22/03/2013 --Kiểm tra ca làm việc đó của công nhân hay văn phòng

        public Boolean CheckShiftDepartmentByTypeName(int iShiftID, String strTypeName)
        {
            String str = String.Format(@"SELECT * FROM dbo.HRShifts WHERE AAStatus='Alive' AND HRShiftName LIKE '{0}%' AND HRShiftID = {1}", strTypeName, iShiftID);
            DataSet ds = GetDataSet(str);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                return true;
            }
            return false;
        }

        #endregion

        #region Lấy tăng ca 2 của nhân viên --Vinh --30/03/2013

        public HRShiftsInfo LayTangCa2CuaNhanVien(String strDepartment, String strOvertimeRateType)
        {
            String str = String.Format(@"SELECT * FROM dbo.HRShifts
                                        WHERE AAStatus='Alive'
                                        AND HRShiftName LIKE '{0}%'
                                        AND HRShiftID IN (
					                                        SELECT FK_HRShiftID FROM dbo.HROvertimeRateDtls 
					                                        WHERE AAStatus='Alive'
					                                        AND FK_HROvertimeRateID IN (
												                                        SELECT HROvertimeRateID FROM dbo.HROvertimeRates 
												                                        WHERE AAStatus='Alive' 
												                                        AND HROvertimeRateTypeCombo LIKE '{1}'
												                                        )
					                                        )", strDepartment, strOvertimeRateType);
            DataSet ds = dal.GetDataSet(str);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count>0)
            {
                return (HRShiftsInfo)dal.GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            }

            return null;
        }

        #endregion
    }
	#endregion
}