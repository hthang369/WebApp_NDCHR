using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region HROfferApprovalWorkDayItems
	//-----------------------------------------------------------
	//Generated By: SQLDBTools.Net ♫ Hồռ؏ ₤ĩռᶋ (v2.0.71)
	//Class: HROfferApprovalWorkDayItemsController
	//Created Date: Wednesday, 28 Feb 2018
	//-----------------------------------------------------------
	
	public class HROfferApprovalWorkDayItemsController : BaseBusinessController
	{
		public HROfferApprovalWorkDayItemsController()
		{
			dal = new DALBaseProvider("HROfferApprovalWorkDayItems",typeof(HROfferApprovalWorkDayItemsInfo));
		}
        public double GetApprovalWorkDayByEmployeeIDAndPeriodID(int iEmployeeID, int iPeriod)
        {
            String str = String.Format(@"SELECT ISNULL(SUM(ISNULL(HROfferApprovalWorkDayItemSuperior,0)),0)
                                        FROM HROfferApprovalWorkDayItems
                                        JOIN dbo.HROfferApprovalWorkDays
                                         ON (HROfferApprovalWorkDays.HROfferApprovalWorkDayID = HROfferApprovalWorkDayItems.FK_HROfferApprovalWorkDayID AND HROfferApprovalWorkDays.AAStatus = HROfferApprovalWorkDayItems.AAStatus)
                                         WHERE HROfferApprovalWorkDayItems.AAStatus='Alive' AND ApprovalStatusCombo='Approved'
                                         AND FK_HRPeriodID={0}
                                         AND FK_HREmployeeID={1}", iPeriod,iEmployeeID);
            DataSet ds= dal.GetDataSet(str);
            if(ds!=null && ds.Tables.Count>0 && ds.Tables[0].Rows.Count>0)
            {
                return Convert.ToDouble(ds.Tables[0].Rows[0][0]);
            }
            return 0;
        }
        public HROfferApprovalWorkDayItemsInfo GetObjectApprovalWorkDayByEmployeeIDAndPeriodID(int iEmployeeID, int iPeriod)
        {
            String str = String.Format(@"SELECT *
                                        FROM HROfferApprovalWorkDayItems
                                        JOIN dbo.HROfferApprovalWorkDays
                                         ON (HROfferApprovalWorkDays.HROfferApprovalWorkDayID = HROfferApprovalWorkDayItems.FK_HROfferApprovalWorkDayID AND HROfferApprovalWorkDays.AAStatus = HROfferApprovalWorkDayItems.AAStatus)
                                         WHERE HROfferApprovalWorkDayItems.AAStatus='Alive' AND ApprovalStatusCombo='Approved'
                                         AND FK_HRPeriodID={0}
                                         AND FK_HREmployeeID={1}", iPeriod, iEmployeeID);
            DataSet ds = dal.GetDataSet(str);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                return (HROfferApprovalWorkDayItemsInfo)dal.GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            }
            return null;
        }
    }
	#endregion
}