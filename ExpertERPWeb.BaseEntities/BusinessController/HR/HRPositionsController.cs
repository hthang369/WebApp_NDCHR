using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region HRPositions
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:HRPositionsController
	//Created Date:Wednesday, April 08, 2009
	//-----------------------------------------------------------
	
	public class HRPositionsController:BaseBusinessController
	{
		public HRPositionsController()
		{
			dal= new DALBaseProvider("HRPositions",typeof(HRPositionsInfo));
		}
        public string GetObjectNoByUser(string strUserName)
        {
            string strQuery = String.Format(@"
SELECT HRPositionNo 
    FROM HRPositions a
        INNER JOIN HREmployees b ON a.HRPositionID = b.FK_HRPositionID
            AND a.AAStatus = 'Alive'
            AND b.AAStatus = 'Alive'
        INNER JOIN ADUsers c ON b.FK_ADUserID = c.ADUserID
            AND c.AAStatus = 'Alive'
            AND c.ADUserName = '{0}'
"
                , strUserName);
            DataSet ds = GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                return (string)ds.Tables[0].Rows[0][0];
            }
            return "";
        }
	}
	#endregion
}