using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region HREmployeeDegrees
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:HREmployeeDegreesController
	//Created Date:Thursday, April 09, 2009
	//-----------------------------------------------------------
	
	public class HREmployeeDegreesController:BaseBusinessController
	{
		public HREmployeeDegreesController()
		{
			dal= new DALBaseProvider("HREmployeeDegrees",typeof(HREmployeeDegreesInfo));
		}

        public HREmployeeDegreesInfo GetLastObject(int iEmployeeID)
        {
            String strQuery = String.Format(@"SELECT  *
                                                FROM    dbo.HREmployeeDegrees
                                                WHERE   AAStatus = 'Alive'
                                                        AND FK_HREmployeeID = {0}
                                                ORDER BY HREmployeeDegreeFinishDate DESC ", iEmployeeID);
            DataSet ds = GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
                return (HREmployeeDegreesInfo)GetObjectFromDataRow(ds.Tables[0].Rows[0]);

            return null;
        }
    }
	#endregion
}