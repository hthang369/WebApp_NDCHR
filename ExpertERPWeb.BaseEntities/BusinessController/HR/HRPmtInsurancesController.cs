using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region HRPmtInsurances
	//-----------------------------------------------------------
	//Generated By: Expert Studio
	//Class:HRPmtInsurancesController
	//Created Date:26 Tháng Chín 2013
	//-----------------------------------------------------------
	
	public class HRPmtInsurancesController:BaseBusinessController
	{
		public HRPmtInsurancesController()
		{
			dal= new DALBaseProvider("HRPmtInsurances",typeof(HRPmtInsurancesInfo));
		}
        public HRPmtInsurancesInfo GetMinPmtInsuran()
        {
            string str = @"SELECT * FROM dbo.HRPmtInsurances 
                        WHERE AAStatus = 'Alive' AND HRPmtInsuranceDate=
                        (
                             SELECT MIN(HRPmtInsuranceDate) FROM dbo.HRPmtInsurances WHERE AAStatus = 'Alive'
                        )";
            DataSet ds = dal.GetDataSet(str);
            if (ds != null)
            {
                if (ds.Tables.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[0].Rows)
                    {
                        HRPmtInsurancesInfo objHRPmtInsurancesInfo = (HRPmtInsurancesInfo)dal.GetObjectFromDataRow(row);
                        return objHRPmtInsurancesInfo;
                    }

                }
            }
            return null;
        }
        public int GetNumberInsuranceByPeriodAndYear(int iPeriod, int iYear)
        {
            string str =string.Format(@"SELECT COUNT(*)  FROM dbo.HRPmtInsurances WHERE AAStatus='Alive' AND HRPmtInsurancePeriod={0} AND HRPmtInsuranceYear={1}",iPeriod,iYear);
            DataSet ds = dal.GetDataSet(str);
            if(ds!=null && ds.Tables.Count>0 && ds.Tables[0].Rows.Count>0)
            {
                return Convert.ToInt32(ds.Tables[0].Rows[0][0]);
            }
            return 0;
        }
	}
	#endregion
}