using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ARPkgFGPlnItems
	//-----------------------------------------------------------
	//Generated By: Expert Studio
	//Class:ARPkgFGPlnItemsController
	//Created Date:Monday, November 19, 2012
	//-----------------------------------------------------------
	
	public class ARPkgFGPlnItemsController:BaseBusinessController
	{
		public ARPkgFGPlnItemsController()
		{
			dal= new DALBaseProvider("ARPkgFGPlnItems",typeof(ARPkgFGPlnItemsInfo));
		}
        public DataSet GetAllProductInShpPlan(int iPeriod, int iYear, double dbFromPriority, double dbToPriority)
        {
            string strQuery = string.Format(@"Select TP.ICProductNo as ICProductFGNo,ARShpPlanItemPkgCBM as ICProductFGVolume,TP.ICProductID as ICProductFGID
                                            ,ARShpPlanItems.ARShpPlanItemHTSQty as ARShpPlanItemFGHTSQty
                                            , BTP.ICProductNo as ICProductNo,BTP.ICProductMaterialCBM as ICProductVolume,BTP.ICProductID as ICProductID
                                            ,PPNormRMs.PPNormRMQty, ARShpPlanItems.ARShpPlanItemHTSQty*PPNormRMs.PPNormRMQty as ARShpPlanItemHTSQty
											,ARShpPlanItems.ARShpPlanItemPriority
                                            from ARShpPlanItems 
                                            inner join PPNorms on  ARShpPlanItems.FK_ICProductID=PPNorms.FK_ICProductID
                                            inner join ICProducts as TP on PPNorms.FK_ICProductID=TP.ICProductID
                                            inner join PPNormRMs on PPNorms.PPNormID=PPNormRMs.FK_PPNormID
                                            inner join ICProducts as BTP on PPNormRMs.FK_ICProductID=BTP.ICProductID
                                            where ARShpPlanItems.AAStatus='Alive' AND TP.AAStatus='Alive' AND BTP.AAStatus='Alive' AND PPNorms.AAStatus='Alive'
                                            And ARShpPlanItemPriority>= {0} and ARShpPlanItemPriority <={1} 
                                            AND FK_ARShpPlanID in (Select ARShpPlanID from ARShpPlans 
                                           where AAStatus='Alive' AND ARShpPlanPeriod={2} AND ARShpPlanYear={3})
                                            order by ARShpPlanItemPriority", dbFromPriority, dbToPriority, iPeriod, iYear);
            return dal.GetDataSet(strQuery);
        }
	}
	#endregion
}