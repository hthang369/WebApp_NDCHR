using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region APSemiDetailOrdPlans
	//-----------------------------------------------------------
	//Generated By: Expert Studio
	//Class:APSemiDetailOrdPlansController
	//Created Date:Wednesday, November 14, 2012
	//-----------------------------------------------------------
	
	public class APSemiDetailOrdPlansController:BaseBusinessController
	{
		public APSemiDetailOrdPlansController()
		{
			dal= new DALBaseProvider("APSemiDetailOrdPlans",typeof(APSemiDetailOrdPlansInfo));
		}
        public double GetTotalQtyByShpPlanItemID(int iShpPlanItemID)
        {
            string strQuery = string.Format(@"Select SUM(APSemiDetailOrdPlanQty) from APSemiDetailOrdPlans where AAStatus='Alive' AND FK_ARShpPlanItemID={0}", iShpPlanItemID);
            DataSet ds = dal.GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0 && ds.Tables[0].Rows[0][0] != DBNull.Value)
                return Convert.ToDouble(ds.Tables[0].Rows[0][0]);
            return 0;
        }
        public DataSet GetAllDataByPOItemID(int iPOItemID)
        {
            string strQuery = string.Format(@"Select * from APSemiDetailOrdPlans where AAStatus='Alive' AND 
                                                  APSemiDetailOrdPlanID in (select FK_APSemiDetailOrdPlanID from APPOItemSemiDetailOrdPlans where FK_APPOItemID={0})", iPOItemID);
            return dal.GetDataSet(strQuery);
        }
        public double GetTotalQtyByFGProductProductANDSO(int iFGProductID,int iProductID, int iSOID)
        {
            string strQuery = string.Format(@"select SUM(APSemiDetailOrdPlanQty) from APSemiDetailOrdPlans where 
                                                        FK_ICProductID={0}
                                                        AND FK_ARShpPlanItemID in (Select ARShpPlanItemID from ARShpPlanItems where AAStatus='Alive'
							                                                        AND FK_ICProductID={1} AND FK_ARSOID={2})", iProductID, iFGProductID, iSOID);
            DataSet ds = dal.GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0 && ds.Tables[0].Rows[0][0] != DBNull.Value)
                return Convert.ToDouble(ds.Tables[0].Rows[0][0]);
            return 0;
        }
    }
	#endregion
}