using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ARSellerTargets
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ARSellerTargetsController
	//Created Date:Friday, April 27, 2012
	//-----------------------------------------------------------
	
	public class ARSellerTargetsController:BaseBusinessController
	{
		public ARSellerTargetsController()
		{
			dal= new DALBaseProvider("ARSellerTargets",typeof(ARSellerTargetsInfo));
		}
        public DataSet GetAllDataByCustomerYear(DateTime dte, int iSellerID)
        {
            String strQuery = String.Format(@"SELECT * FROM dbo.ARSellerTargets WHERE ARSellerTargetYear*12+ARSellerTargetPeriod>={0}
                                                    AND {1}>ARSellerTargetYear*12+ARSellerTargetPeriod
                                                AND AAStatus='Alive' AND FK_ARSellerID={2} ORDER BY ARSellerTargetYear, ARSellerTargetPeriod", dte.Year * 12 + dte.Month, dte.AddYears(1).Year * 12 + dte.Month, iSellerID);
            return dal.GetDataSet(strQuery);
        }
        public double GetTargetAmtBySellerIDPeriodYear(int iSellerID, int iPeriod, int iYear)
        {
            string str = string.Format(@"SELECT ARSellerTargetAmt FROM ARSellerTargets WHERE AAStatus='Alive' AND FK_ARSellerID={0} AND 
                                                ARSellerTargetPeriod={1} AND ARSellerTargetYear={2}"
                                        ,iSellerID,iPeriod,iYear );
            DataSet ds = dal.GetDataSet(str);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0 && ds.Tables[0].Rows[0][0] != DBNull.Value)
                return Convert.ToDouble(ds.Tables[0].Rows[0][0]);
            return 0;
        }
        public DataSet GetObjectBySellerIDPeriodYear(int iSellerID, int iPeriod, int iYear)
        {
            string str = string.Format(@"SELECT top 1 * FROM ARSellerTargets WHERE AAStatus='Alive' AND FK_ARSellerID={0} AND 
                                                ARSellerTargetPeriod={1} AND ARSellerTargetYear={2}"
                                        , iSellerID, iPeriod, iYear);
            return  dal.GetDataSet(str);
        }
	}
	#endregion
}