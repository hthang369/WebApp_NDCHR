using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ARCustomerTagets
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ARCustomerTagetsController
	//Created Date:25 Tháng Tư 2012
	//-----------------------------------------------------------
	
	public class ARCustomerTagetsController:BaseBusinessController
	{
		public ARCustomerTagetsController()
		{
			dal= new DALBaseProvider("ARCustomerTagets",typeof(ARCustomerTagetsInfo));
		}

        public ARCustomerTagetsInfo GetCustomerTagetByPeriodAndYear(int iPeriod, int iYear, int iCustomerID)
        {
            String strQuery = String.Format(@"SELECT * FROM  ARCustomerTagets Where AAStatus = 'Alive' And ARCustomerTagetPeriod = {0} AND ARCustomerTagetYear = {1} And FK_ARCustomerID = {2}", iPeriod, iYear, iCustomerID);
            DataSet ds = dal.GetDataSet(strQuery);

            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0 && ds.Tables[0].Rows[0][0] != DBNull.Value)
                return (ARCustomerTagetsInfo)dal.GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            return null;
        }
        public DataSet GetAllDataByCustomerYear(DateTime dte, int iCustomerID)
        {
            String strQuery = String.Format(@"SELECT * FROM dbo.ARCustomerTagets WHERE ARCustomerTagetYear*12+ARCustomerTagetPeriod>={0}
                                                    AND {1}>ARCustomerTagetYear*12+ARCustomerTagetPeriod
                                                AND AAStatus='Alive' AND FK_ARCustomerID={2} ORDER BY ARCustomerTagetYear, ARCustomerTagetPeriod", dte.Year*12+dte.Month,dte.AddYears(1).Year*12+dte.Month, iCustomerID);
            return dal.GetDataSet(strQuery);
        }
	}
	#endregion
}