using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ARCustomerCons
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ARCustomerConsController
	//Created Date:Friday, March 27, 2009
	//-----------------------------------------------------------
	
	public class ARCustomerConsController:BaseBusinessController
	{
		public ARCustomerConsController()
		{
			dal= new DALBaseProvider("ARCustomerCons",typeof(ARCustomerConsInfo));
		}

        public List<ARCustomerConsInfo> GetARCustomerContactsListByARCustomerIDAndARCustomerContactType(int iARCustomerID, String strARCustomerContactType)
        {
            List<ARCustomerConsInfo> lstARCustomerConsInfo = new List<ARCustomerConsInfo>();

            DataSet dsARCustomerCons = GetAllDataByForeignColumn("FK_ARCustomerID", iARCustomerID);
            if (dsARCustomerCons.Tables.Count > 0)
            {
                foreach (DataRow rowARCustomerCon in dsARCustomerCons.Tables[0].Rows)
                {
                    ARCustomerConsInfo objARCustomerConsInfo = (ARCustomerConsInfo)GetObjectFromDataRow(rowARCustomerCon);
                    if (objARCustomerConsInfo.ARCustomerConTypeCombo.Contains(strARCustomerContactType))
                        lstARCustomerConsInfo.Add(objARCustomerConsInfo);
                }
            }

            return lstARCustomerConsInfo;
        }

        public ARCustomerConsInfo GetARCustomerContactDefaultByARCustomerAndContactType(int iARCustomerID, String strARCustomerContactType)
        {
            string strQuery = string.Format("Select * from ARCustomerCons where AAStatus='Alive' and FK_ARCustomerID={0} and ARContactType='{1}'", iARCustomerID, strARCustomerContactType);
            DataSet ds = dal.GetDataSet(strQuery);
            if(ds!=null &&ds.Tables.Count>0&&ds.Tables[0].Rows.Count>0)
            {
                return (ARCustomerConsInfo)GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            }
            return null;
        }
        public DataSet GetAllObjectByCustomerID(int iCustomerID)
        {
            string strQuery = string.Format("SELECT * FROM ARCustomerCons WHERE FK_ARCustomerID = {0} AND AAStatus = 'Alive'", iCustomerID);
            return GetDataSet(strQuery);
        }

        public DataSet GetCusConByTypeAndCusID(int iCustomerID)
        {
            string strQuery = string.Format(@"SELECT * FROM dbo.ARCustomerCons
                                            WHERE AAStatus = 'Alive'
                                            AND ARCustomerConTypeCombo = 'Stock'
                                            AND FK_ARCustomerID = {0}", iCustomerID);
            return GetDataSet(strQuery);
        }
	}
	#endregion
}