using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ARCustReqs
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ARCustReqsController
	//Created Date:Tuesday, December 16, 2014
	//-----------------------------------------------------------
	
	public class ARCustReqsController:BaseBusinessController
	{
		public ARCustReqsController()
		{
			dal= new DALBaseProvider("ARCustReqs",typeof(ARCustReqsInfo));
		}
        public DataSet LayTatCaDuLieuChuaTaoPhanTich(int iARCustReqID)
        {
            String str = String.Format(@"SELECT  ARCustReqID,ARCustReqNo,ARCustReqName
                                        FROM    dbo.ARCustReqs
                                        WHERE   AAStatus = 'Alive'
                                                AND ARCustReqID NOT IN ( SELECT FK_ARCustReqID
                                                                                     FROM   dbo.ARCustReqAnalyzes
                                                                                     WHERE  AAStatus = 'Alive' 
                                                                                     AND FK_ARCustReqID<>{0})
                                                    "
                                        , iARCustReqID);
            return dal.GetDataSet(str);
        }
        public DataSet LayTatCaDuLieuDaTaoPhanTich(int iARCustReqID, String strApproval, String strAnalyzeStatusCombo, String strProjectTypeCombo)
        {
            String str = String.Format(@"SELECT  *
                                        FROM    dbo.ARCustReqs
                                        WHERE   AAStatus = 'Alive'
                                                AND ( ARCustReqID = {0}
                                                      OR ARCustReqID IN ( SELECT FK_ARCustReqID
                                                                        FROM   dbo.ARCustReqAnalyzes
                                                                        WHERE  AAStatus = 'Alive'
                                                                        AND ApprovalStatusCombo = '{1}'
                                                                        AND ARCustReqAnalyzeStatusCombo = '{2}'
                                                                        AND ARProjectTypeCombo LIKE '{3}%'
                                                                        AND ARCustReqAnalyzeID NOT IN ( SELECT FK_ARCustReqAnalyzeID
                                                                                                         FROM   dbo.ARBiddingPlns
                                                                                                         WHERE  AAStatus = 'Alive' ))
                                                    OR ARCustReqID IN (
                                                                          SELECT    ARCustReqID
                                                                          FROM      dbo.ARCustReqs
                                                                          WHERE     AAStatus = 'Alive'
                                                                                    AND ARCustReqStatusCombo = '{2}'
                                                                                    AND ARCustReqID NOT IN ( SELECT FK_ARCustReqID
                                                                                                             FROM   dbo.ARBiddingPlns
                                                                                                             WHERE  AAStatus = 'Alive' ) ))"
                                        , iARCustReqID, strApproval, strAnalyzeStatusCombo, strProjectTypeCombo);
            return dal.GetDataSet(str);
        }

        public DataSet LayTatCaDuLieuThuongMai(int iARCustReqID, String strStatusCombo, String strProjectTypeComboCommerce, String strProjectTypeComboDefault)
        {
            String str = String.Format(@"SELECT  *
                                        FROM    dbo.ARCustReqs
                                        WHERE   AAStatus = 'Alive'
                                                AND ( ARCustReqID = {0} OR {0} = 0)
                                                AND ARCustReqStatusCombo = '{1}'
                                                AND (ARProjectTypeCombo LIKE '{2}%' OR ARProjectTypeCombo LIKE '{3}%')"
                                        , iARCustReqID, strStatusCombo, strProjectTypeComboCommerce, strProjectTypeComboDefault);
            return dal.GetDataSet(str);
        }
	}
	#endregion
}