using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region CMWarantyHistorys
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:CMWarantyHistorysController
	//Created Date:Thursday, June 23, 2011
	//-----------------------------------------------------------
	
	public class CMWarantyHistorysController:BaseBusinessController
	{
		public CMWarantyHistorysController()
		{
			dal= new DALBaseProvider("CMWarantyHistorys",typeof(CMWarantyHistorysInfo));
		}

        public DataSet GetAllHistoryByWaranty(CMWarantysInfo Waranty)
        {
            String strQuery1 = String.Format(@"SELECT * FROM CMWarantyHistorys WHERE AAStatus = 'Alive' AND  CMWarantyNo = '{0}'", Waranty.CMWarantyNo);
            String strQuery2 = String.Format(@"SELECT * FROM CMWarantyHistorys WHERE AAStatus = 'Alive' AND  FK_CMWarantyID = {0}", Waranty.CMWarantyID);

            String strQuery = strQuery1 + " UNION ALL " + strQuery2;

            return dal.GetDataSet(strQuery);
        }

        public DataSet GetAllHistoryOverDues(DateTime DateFrom, DateTime DateTo)
        {
            String strQuery = String.Format("SELECT * FROM [dbo].[CMWarantyHistorys] WHERE CONVERT(VARCHAR(10), [CMWarantyHistoryExDate], 112)>= CONVERT(VARCHAR(10), '{0}', 112) AND CONVERT(VARCHAR(10), [CMWarantyHistoryExDate], 112)<= CONVERT(VARCHAR(10), '{1}', 112) AND [AAStatus]='{2}'", DateFrom.ToString("yyyyMMdd"), DateTo.ToString("yyyyMMdd"), BusinessObject.DefaultAAStatus);
            return dal.GetDataSet(strQuery);
        }
	}
	#endregion
}