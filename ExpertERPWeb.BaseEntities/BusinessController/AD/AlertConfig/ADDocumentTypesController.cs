using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region ADDocumentTypes
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:ADDocumentTypesController
	//Created Date:09 Tháng Tám 2012
	//-----------------------------------------------------------
	
	public class ADDocumentTypesController:BaseBusinessController
	{
		public ADDocumentTypesController()
		{
			dal= new DALBaseProvider("ADDocumentTypes",typeof(ADDocumentTypesInfo));
		}

        public DataSet GetAllModule()
        {
            string strQuery = string.Format(@" Select STModuleDescriptionID AS FK_STModuleDescriptionID, STModuleDescriptionDescription AS STModuleDescription,STModuleName from STModules left JOIN dbo.STModuleDescriptions 
                                                ON STModuleDescriptions.STModuleID = STModules.STModuleID  
                                                WHERE STModuleDescriptionID IS NOT NULL 
                                                 AND STModules.STModuleID IN (SELECT FK_STModuleID from CSCompanyModules )
                                                 ");
            return dal.GetDataSet(strQuery);
        }
        public DataSet GetCompanyModuleByType(string psModuleType)
        {
            string strQuery = String.Format(@"SELECT STModuleDescriptionID as FK_STModuleDescriptionID, STModuleDescriptionDescription,STModuleName FROM STModules a 
				INNER JOIN STModuleDescriptions b ON a.STModuleID = b.STModuleID AND STModuleType IN ('{0}')
				INNER JOIN CSCompanyModules c ON a.STModuleID = c.FK_STModuleID
				", psModuleType.Replace(",", "','"));
            return GetDataSet(strQuery);
        }
	}
	#endregion
}