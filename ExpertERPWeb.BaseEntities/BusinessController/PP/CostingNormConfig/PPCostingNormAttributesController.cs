using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region PPCostingNormAttributes
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:PPCostingNormAttributesController
	//Created Date:Tuesday, September 20, 2016
	//-----------------------------------------------------------
	
	public class PPCostingNormAttributesController:BaseBusinessController
	{
		public PPCostingNormAttributesController()
		{
			dal= new DALBaseProvider("PPCostingNormAttributes",typeof(PPCostingNormAttributesInfo));
		}
        public DataSet GetAllDataByArrayPPCostingNormProductID(string[] arrPPCostingNormProductID)
        {
            string strQuery = string.Format(@"
                                            SELECT  *
                                            FROM    dbo.PPCostingNormAttributes
                                            WHERE   FK_PPCostingNormRMID IN (
                                                    SELECT  PPCostingNormRMID
                                                    FROM    dbo.PPCostingNormRMs
                                                    WHERE   FK_PPCostingNormProductID IN (
                                                            SELECT  PPCostingNormProductID
                                                            FROM    dbo.PPCostingNormProducts 
				                                            WHERE PPCostingNormProductID IN ({0})
                                                                  AND AAStatus = 'Alive')
                                                     AND AAStatus = 'Alive')
                                            AND AAStatus = 'Alive'
                                            ", string.Join(",", arrPPCostingNormProductID)
                                            );
            return GetDataSet(strQuery);
        }
        public DataSet GetAllDataByArrayPPNormID(string[] arrPPNormID)
        {
            string strSubQuery = DALUtil.GenerateColumnsFromTable("PPNormAttributes", dal.TableName);
            string strQuery = string.Format(@"{0}
                            DECLARE @sql NVARCHAR(MAX)
                            SET @sql = 'SELECT  ' + @column + '
                                            FROM    {1}
                                            WHERE   FK_PPNormRMID IN (
                                                    SELECT  PPNormRMID
                                                    FROM    dbo.PPNormRMs
                                                    WHERE   FK_PPNormID IN (
                                                            SELECT  PPNormID
                                                            FROM    dbo.PPNorms
				                                            WHERE PPNormID IN ({2})
                                                                  AND AAStatus =  ''Alive'') 
                                                    AND AAStatus =  ''Alive'')
                                             AND AAStatus =  ''Alive'''
                            EXEC sp_executesql @sql
                                            ", strSubQuery, "PPNormAttributes", string.Join(",", arrPPNormID)
                                            );
            return GetDataSet(strQuery);
        }
        public void UpdateAAStatusByCostingNormProduct(string[] arrPPCostingNormProductID, string pAAStatus)
        {
            string strQuery = string.Format(@"
                                            UPDATE   dbo.PPCostingNormAttributes
                                            SET AAStatus='{1}'
                                            WHERE   FK_PPCostingNormRMID IN (
                                                    SELECT  PPCostingNormRMID
                                                    FROM    dbo.PPCostingNormRMs
                                                    WHERE   FK_PPCostingNormProductID IN ( {0} )
				                                            AND AAStatus='Alive'
		                                            )                                              
                                            ", string.Join(",", arrPPCostingNormProductID), pAAStatus);
            GetDataSet(strQuery);
        }
    }
	#endregion
}