using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region PPCostCenterChildAllocations
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:PPCostCenterChildAllocationsController
	//Created Date:Tuesday, October 18, 2016
	//-----------------------------------------------------------
	
	public class PPCostCenterChildAllocationsController:BaseBusinessController
	{
		public PPCostCenterChildAllocationsController()
		{
			dal= new DALBaseProvider("PPCostCenterChildAllocations",typeof(PPCostCenterChildAllocationsInfo));
		}

        public DataSet GetAllData_ByCostCenterAndPeriod(int pPPCostCenterID,int pPeriod,int pYear)
        {
            string strQuery = string.Format(@"
                                            SELECT  *
                                            FROM    dbo.PPCostCenterChildAllocations
                                            WHERE   FK_PPCostAllocationID = ( SELECT    PPCostAllocationID
                                                                              FROM      dbo.PPCostAllocations
                                                                              WHERE     PPPeriod = '{1}'
                                                                                        AND PPYear = '{2}'
                                                                                        AND AAStatus = 'Alive'
                                                                            )
                                                    AND AAStatus = 'Alive'
		                                            AND FK_PPCostCenterParentID='{0}'
                                            ", pPPCostCenterID,pPeriod,pYear);
            return GetDataSet(strQuery);
        }

        public DataSet GetAllData_ByCostCenterParentAndCostAllocation(int pPPCostCenterParentID,int pCostAllocationID)
        {
            string strQuery = string.Format(@"
                                            SELECT * 
                                            FROM PPCostCenterChildAllocations
                                            WHERE FK_PPCostCenterParentID={0}
                                            AND FK_PPCostAllocationID={1}
                                            AND AAStatus='Alive'
                                            ", pPPCostCenterParentID, pCostAllocationID);
            return GetDataSet(strQuery);
        }
       
        public DataSet GetAllData_ByCostCenterParentArrayAndCostCenterID(string[] arrCostCenterParentID,int pCostCenterID)
        {
            string strQuery = string.Format(@"
                                            SELECT  *
                                            FROM    dbo.PPCostCenterChildAllocations
                                            WHERE   FK_PPCostCenterParentID IN ({0})
                                                    AND FK_PPCostCenterID = {1}
                                                    AND AAStatus='Alive'
                                            ", string.Join(",", arrCostCenterParentID),pCostCenterID);
            return GetDataSet(strQuery);
        }
    }
	#endregion
}