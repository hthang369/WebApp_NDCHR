using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region PPProductFactorItems
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:PPProductFactorItemsController
	//Created Date:Thursday, June 23, 2016
	//-----------------------------------------------------------
	
	public class PPProductFactorItemsController:BaseBusinessController
	{
		public PPProductFactorItemsController()
		{
			dal= new DALBaseProvider("PPProductFactorItems",typeof(PPProductFactorItemsInfo));
		}
        public DataSet GetAllData_ByPeriod(DateTime dt)
        {
            string strQuery = string.Format(@"
                                            SELECT  *
                                            FROM    dbo.PPProductFactorItems
                                            WHERE   FK_PPProductFactorID = ( SELECT TOP 1 PPProductFactorID
                                                                             FROM   dbo.PPProductFactors
                                                                             WHERE '{0}'>= CONVERT(VARCHAR(20), PPProductFactorApplyFromDate, 112)
                                                                                    AND '{0}' <= CONVERT(VARCHAR(20), PPProductFactorApplyToDate, 112)
																				ORDER BY PPProductFactorApplyFromDate DESC,PPProductFactorApplyToDate ASC,PPProductFactorID DESC
                                                                           )
                                            ", dt.ToString("yyyyMMdd"));
            return GetDataSet(strQuery);
        }
        public bool CheckProductIsExistInProductFactor(int pPPProductFactorID, int pICProductID)
        {
            string strQuery = string.Format(@"
                                        SELECT * 
                                        FROM dbo.PPProductFactorItems
                                        WHERE FK_PPProductFactorID = '{0}' 
                                              AND AAStatus='Alive' 
                                              AND FK_ICProductID= '{1}'
                                            ", pPPProductFactorID, pICProductID);
            DataSet ds = GetDataSet(strQuery);
            if (ds != null && ds.Tables[0].Rows.Count > 0)
            {
                return true;
            }
            return false;
        }
    }
	#endregion
}