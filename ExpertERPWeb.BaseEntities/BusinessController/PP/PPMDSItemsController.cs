using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
    #region PPMDSItems
    //-----------------------------------------------------------
    //Generated By: GMC Studio
    //Class:PPMDSItemsController
    //Created Date:01 Tháng Tám 2014
    //-----------------------------------------------------------

	public class PPMDSItemsController:BaseBusinessController
    {
        public PPMDSItemsController()
        {
			dal= new DALBaseProvider("PPMDSItems",typeof(PPMDSItemsInfo));
        }
        public DataSet GetAllDataByMDSOrderByProductAndSO(int iPPMDSID)
        {
            string strQuery = string.Format(@"SELECT  
                                                        PMDSItems.*
                                                FROM    PPMDSItems
                                                INNER JOIN dbo.ICProducts ON (ICProducts.ICProductID = PPMDSItems.FK_ICProductID
                                                AND ICProducts.AAStatus = PPMDSItems.AAStatus
                                                AND ICProducts.AAStatus = 'Alive')
                                                WHERE FK_PPMDSID = {0}		
                                                ORDER BY PPMDSItems.PPMDSItemETDDate", iPPMDSID);
            return dal.GetDataSet(strQuery);
        }
        public DataSet GetAllDataByMDSProductInRange(int iPPMDSID,int FK_ICProductID,DateTime dteFromDate,DateTime dteToDate)
        {
            string strQuery = string.Format(@"  SELECT PPMDSItems.*
                                                FROM PPMDSItems
                                                WHERE PPMDSItems.AAStatus = 'Alive'
                                                      AND (
                                                              PPMDSItems.FK_PPMDSID = {0}
                                                              OR {0} = 0
                                                          )
                                                      AND (
                                                              PPMDSItems.FK_ICProductID = {1}
                                                              OR {1} = 0
                                                          )
                                                      AND (CONVERT(VARCHAR(10), PPMDSItemETDDate, 112)
                                                      BETWEEN CONVERT(VARCHAR(10), '{2}', 112) AND CONVERT(VARCHAR(10), '{3}', 112)
                                                          );", iPPMDSID, FK_ICProductID, dteFromDate.ToString("yyyyMMdd"), dteToDate.ToString("yyyyMMdd"));
            return dal.GetDataSet(strQuery);
        }

        public void DeleteAllData()
        {
            string str = string.Format(@"DELETE dbo.PPMDSItems
                                         WHERE AAStatus != 'Dummy'");
            dal.GetDataSet(str);
        }
    }
    #endregion
}