using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region GLProductionCostFactors
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:GLProductionCostFactorsController
	//Created Date:14 March 2013
	//-----------------------------------------------------------
	
	public class PPProductionCostFactorsController:BaseBusinessController
	{
		public PPProductionCostFactorsController()
		{
			dal= new DALBaseProvider("PPProductionCostFactors",typeof(PPProductionCostFactorsInfo));
		}

        public DataSet GetAllProductionCostFatorByType(String strType)
        {
            String strQuery = String.Format(@"SELECT * 
                                                FROM PPProductionCostFactors
                                                WHERE AAStatus = 'Alive'
                                                AND PPProductionCostFactorTypeCombo = '{0}'", strType);

            return GetDataSet(strQuery);
        }
		 public DataSet GetAllDataByYearANDPeriod(int iYear, int iPeriod, String strType)
        {
            String strQuery = String.Format(@"  SELECT * FROM PPProductionCostFactors
                                                WHERE PPYear = {0}
                                                AND PPPeriod = {1}
                                                AND PPProductionCostFactorTypeCombo = '{2}'
                                                ",iYear, iPeriod, strType);

            return GetDataSet(strQuery);
        }

        public void DeleteAllDataByYearANDPeriod(int iYear, int iPeriod)
        {
            String str = String.Format(@"   DELETE dbo.PPProductionCostFactors
                                            WHERE PPYear = {0}
                                            AND PPPeriod = {1}"
                                            , iYear, iPeriod);
            dal.GetDataSet(str);
        }

        public DataSet GetAllDataByYearANDPeriod(int iYear, int iPeriod)
        {
            String str = String.Format(@"   SELECT * FROM dbo.PPProductionCostFactors
                                            WHERE PPYear = {0}
                                            AND PPPeriod = {1}"
                                            , iYear, iPeriod);
            return dal.GetDataSet(str);
        }

        public Boolean CheckDataInYearANDPeriod(int iYear, int iPeriod)
        {
            DataSet ds = GetAllDataByYearANDPeriod(iYear, iPeriod);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0) return true;
            return false;
        }
	}
	#endregion
}