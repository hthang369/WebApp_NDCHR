using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region PPProductionOrdrEstRMs
	//-----------------------------------------------------------
	//Generated By: Expert Studio
	//Class:PPProductionOrdrEstRMsController
	//Created Date:Wednesday, November 28, 2012
	//-----------------------------------------------------------
	
	public class PPProductionOrdrEstRMsController:BaseBusinessController
	{
		public PPProductionOrdrEstRMsController()
		{
			dal= new DALBaseProvider("PPProductionOrdrEstRMs",typeof(PPProductionOrdrEstRMsInfo));
        }

        #region Lấy tất cả nguyên vật liệu dự tính của phiếu sản xuất dựa vào thành phẩm ---Vinh

        public DataSet GetAllDataByProductionOrdrANDFG(int iPPProductionOrdrID, int iICProductFGID)
        {
            String str = String.Format(@"", iPPProductionOrdrID, iICProductFGID);
            return dal.GetDataSet(str);
        }

        #endregion
        //NhamNDH add -25/11/2016- Move lệnh sản xuất từ CHF
        public DataSet GetAllDataNotComplete(int iPPWOID)
        {
            string strQuery = string.Format(@"SELECT  *
                                            FROM    dbo.PPProductionOrdrEstRMs
                                                    INNER JOIN dbo.PPProductionOrdrs ON PPProductionOrdrs.PPProductionOrdrID = PPProductionOrdrEstRMs.FK_PPProductionOrdrID
                                                                                        AND PPProductionOrdrs.AAStatus = PPProductionOrdrEstRMs.AAStatus
                                                                                        AND PPProductionOrdrs.AAStatus = 'Alive'
                                                                                        AND PPProductionOrdrs.FK_PPWOID = {0}
                                            WHERE   PPProductionOrdrEstRMs.PPProductionOrdrEstRMRQty > 0", iPPWOID);
            return GetDataSet(strQuery);
        }
        //NhamNDH add -28/11/2016- Move Phiếu sản xuất từ CHF
        public DataSet GetAllDataNotCompleteByProductionOrdr(int iPPProductionOrdrID)
        {
            string strQuery = string.Format(@"SELECT  *
                                                FROM    dbo.PPProductionOrdrEstRMs
                                                WHERE   AAStatus = 'Alive'
                                                        AND FK_PPProductionOrdrID = {0}
                                                        AND PPProductionOrdrEstRMs.PPProductionOrdrEstRMRQty > 0", iPPProductionOrdrID);
            return GetDataSet(strQuery);
        }
        public DataSet GetAllDataByCondition(int iWOID, int iPPProductionOrdrID, int iARSOID, int iARSOItemID, int iPPPhaseCfgID, int iFGProductID)
        {
            string strQuery = string.Format(@"SELECT 
			                                                PPProductionOrdrEstRMs.*
                                                FROM dbo.PPProductionOrdrs
                                                    INNER JOIN dbo.PPProductionOrdrEstRMs
                                                        ON PPProductionOrdrEstRMs.FK_PPProductionOrdrID = PPProductionOrdrs.PPProductionOrdrID
                                                           AND PPProductionOrdrEstRMs.AAStatus = 'Alive'
                                                WHERE PPProductionOrdrEstRMs.FK_PPWOID = {0}
	                                                  AND PPProductionOrdrs.PPProductionOrdrID ={1}
                                                      AND PPProductionOrdrEstRMs.FK_ARSOID = {2}
                                                      AND PPProductionOrdrEstRMs.FK_ARSOItemID = {3}
                                                      AND PPProductionOrdrEstRMs.FK_PPPhaseCfgID = {4}
                                                      AND PPProductionOrdrEstRMs.FK_ICFGProductID = {5};", iWOID, iPPProductionOrdrID, iARSOID, iARSOItemID, iPPPhaseCfgID, iFGProductID);
            return GetDataSet(strQuery);
        }
        public PPProductionOrdrEstRMsInfo GetFirstObjectByMainID(int iPPProductionOrdrID)
        {
            string strQuery = string.Format(@"SELECT  *
                                                FROM    dbo.PPProductionOrdrEstRMs
                                                WHERE   AAStatus = 'Alive'
                                                        AND FK_PPProductionOrdrID = {0}", iPPProductionOrdrID);
            DataSet ds = GetDataSet(strQuery);
            if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
                return (PPProductionOrdrEstRMsInfo)GetObjectFromDataRow(ds.Tables[0].Rows[0]);
            else
                return null;
        }
    }
	#endregion
}