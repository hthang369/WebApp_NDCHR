using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region PPWorkCenters
	//-----------------------------------------------------------
	//Generated By: Expert Studio
	//Class:PPWorkCentersController
	//Created Date:12 Tháng Tám 2014
	//-----------------------------------------------------------
	
	public class PPWorkCentersController:BaseBusinessController
	{
		public PPWorkCentersController()
		{
			dal= new DALBaseProvider("PPWorkCenters",typeof(PPWorkCentersInfo));
		}
        public DataSet GetAllDataByICProductIDAndPhaseCfgID(int iICProductID, int iPPPhaseCfgID)
        {
            string strQuery = string.Format(@"  SELECT *
                                                FROM dbo.PPWorkCenters
                                                WHERE PPWorkCenters.AAStatus = 'Alive'
                                                      AND EXISTS
                                                (
                                                    SELECT 'x'
                                                    FROM dbo.PPRoutingOperations
                                                        INNER JOIN dbo.PPRoutings
                                                            ON PPRoutings.PPRoutingID = PPRoutingOperations.FK_PPRoutingID
                                                               AND PPRoutings.AAStatus = 'Alive'
                                                        INNER JOIN dbo.ICProducts
                                                            ON ICProducts.FK_PPRoutingID = PPRoutings.PPRoutingID
                                                               AND ICProducts.FK_PPRoutingID = PPRoutings.PPRoutingID
                                                               AND ICProducts.AAStatus = 'Alive'
                                                    WHERE PPRoutingOperations.AAStatus = 'Alive'
                                                          AND (
                                                                  ICProducts.ICProductID = {0}
                                                                  OR 0 = {0}
                                                              )
                                                          AND (
                                                                  PPRoutingOperations.FK_PPPhaseCfgID = {1}
                                                                  OR 0 = {1}
                                                              )
                                                          AND PPRoutingOperations.FK_PPWorkCenterID = PPWorkCenters.PPWorkCenterID
                                                );", iICProductID, iPPPhaseCfgID);
            return dal.GetDataSet(strQuery);
        }
    }
	#endregion
}