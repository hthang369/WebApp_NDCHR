using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using ExpertWebLib;
namespace ExpertERP.BusinessEntities
{
	#region PPCostFactors
	//-----------------------------------------------------------
	//Generated By: GMC Studio
	//Class:PPCostFactorsController
	//Created Date:14 Tháng Mười Một 2014
	//-----------------------------------------------------------
	
	public class PPCostFactorsController:BaseBusinessController
	{
		public PPCostFactorsController()
		{
			dal= new DALBaseProvider("PPCostFactors",typeof(PPCostFactorsInfo));
		}

        public DataSet GetAllDataByType(String strPPCostFactorTypeCombo)
        {
            String str = String.Format(@"SELECT * FROM dbo.PPCostFactors
                                        WHERE AAStatus = 'Alive'
                                        AND PPCostFactorTypeCombo = '{0}'"
                                        , strPPCostFactorTypeCombo);
            return dal.GetDataSet(str);
        }
        public DataSet GetAllData_ByID(int iPPCostFactorID)
        {
            String str = String.Format(@"SELECT * FROM dbo.PPCostFactors
                                        WHERE AAStatus = 'Alive'
                                             AND PPCostFactorID='{0}'
                                        ORDER by PPCostFactorID ASC", iPPCostFactorID);
            return dal.GetDataSet(str);
        }
        public DataSet GetAllData_NotInCostFactorAllocate(string strPPCostFactorTypeCombo,int iPPCostCenterID)
        {
            string strQuery = String.Format(@"SELECT  *
                                              FROM    dbo.PPCostFactors
                                              WHERE   AAStatus = 'Alive'
                                                    AND PPCostFactorTypeCombo = '{0}'
                                                    AND PPCostFactorID NOT IN ( SELECT  FK_PPCostFactorID
                                                                                FROM    dbo.PPCostFactorAllocates
                                                                                WHERE   FK_PPCostFactorID IS NOT NULL
                                                                                        AND FK_PPCostCenterID = '{1}'
                                                    )", strPPCostFactorTypeCombo, iPPCostCenterID);
            return GetDataSet(strQuery);
        }
        public DataSet GetAllData_InCostFactorAllocate(string strPPCostFactorTypeCombo, int iPPCostCenterID)
        {
            string strQuery = String.Format(@"SELECT  *
                                              FROM    dbo.PPCostFactors
                                              WHERE   AAStatus = 'Alive'
                                                    AND PPCostFactorTypeCombo = '{0}'
                                                    AND PPCostFactorID IN ( SELECT  FK_PPCostFactorID
                                                                                FROM    dbo.PPCostFactorAllocates
                                                                                WHERE   FK_PPCostFactorID IS NOT NULL
                                                                                        AND FK_PPCostCenterID = '{1}'
                                                    )", strPPCostFactorTypeCombo, iPPCostCenterID);
            return GetDataSet(strQuery);
        }
        
	}
	#endregion
}